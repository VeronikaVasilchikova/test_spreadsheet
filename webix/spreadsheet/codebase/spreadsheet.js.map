{"version":3,"file":"spreadsheet.js","sources":["../sources/math/methods/helpers.js","../sources/views/date.js","../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/views/suggest_formula.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/math/parser.js","../sources/views/button.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/views/ui.js","../sources/views/series.js","../sources/editors/date.js","../sources/editors/richselect.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/table.js","../sources/hotkeys.js","../sources/math/methods/numbers.js","../sources/math/methods/strings.js","../sources/math/methods/date.js","../sources/math/methods/other.js","../sources/math/methods.js","../sources/operations/types.js","../sources/editor.js","../sources/helpers/array.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/math/writer.js","../sources/dialogs/imagecell.js","../sources/dialogs/imagetop.js","../sources/math/cache.js","../sources/math/updater.js","../sources/math/sheet.js","../sources/math/ranges.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/operations/lock_cell.js","../sources/operations/spans.js","../sources/operations/filter.js","../sources/dialogs/filter.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/undo.js","../sources/operations/views.js","../sources/chart.js","../sources/operations/add_row_col.js","../sources/math/math.js","../sources/math/placeholder.js","../sources/operations/conditional_formats.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/data.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/filter.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/helpers/conditional.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["export function dayOfTheYear(date){\n\tconst start = new Date(date.getFullYear(), 0, 0);\n\tconst diff = (date - start) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000);\n\treturn Math.floor(diff / (1000 * 60 * 60 * 24));\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date(Math.round((excelDate - 25569) * 86400 * 1000));\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}\n\nexport function _to_number(v){\n\tif(v || v === 0){\n\t\tv = v*1;\n\t\tif(!isNaN(v)) return v;\n\t}\n\treturn false;\n}\n\nexport function _combine(data){\n\tvar arr = [];\n\tfor (var i = 0; i < data.length; i++){\n\t\tarr = arr.concat(data[i]);\n\t}\n\treturn arr;\n}","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\n\nfunction getJsDate(value){\n\tif ((value || value === 0) && !(value instanceof Date) && !isNaN(value)){\n\t\tvalue = getJsDateFromExcel(value);\n\t}\n\treturn value;\n}\n\nfunction getExcelDate(value){\n\tif (value && value instanceof Date){\n\t\tvalue = getExcelDateFromJs(value);\n\t}\n\treturn value;\n}\n\nwebix.protoUI({\n\t$cssName: \"datepicker\",\n\tname: \"ssheet-datepicker\",\n\tgetValue:function(){\n\t\tconst value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\treturn getExcelDate(value) || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tvalue = getJsDate(value);\n\t\treturn webix.ui.datepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.datepicker);\n\nwebix.protoUI({\n\t$cssName: \"daterangepicker\",\n\tname: \"ssheet-daterangepicker\",\n\tgetValue:function(){\n\t\tlet value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\tif (value){\n\t\t\tvalue = webix.copy(value);\n\t\t\tvalue.start = getExcelDate(value.start);\n\t\t\tvalue.end = getExcelDate(value.end);\n\t\t}\n\t\treturn value || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tif (!value){\n\t\t\tvalue = { start:null, end:null };\n\t\t}\n\t\telse if (!value.start && !value.end)\n\t\t\tvalue = { start:value };\n\n\t\tvalue.start = getJsDate(value.start);\n\t\tvalue.end = getJsDate(value.end);\n\n\t\treturn webix.ui.daterangepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.daterangepicker);","import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-operator\": \"Operator\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t//charts\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\",\n\t\t\"fit-content\": \"Fit to content\",\n\t\t//views\n\t\t\"edit-view\":\"Edit\",\n\t\t\"remove-view\":\"Remove\",\n\t\t\"chart-edit\":\"Edit chart\",\n\n\t\t\"chart-common\":\"Common\",\n\t\t\"chart-series\":\"Series\",\n\t\t\"chart-extras\":\"Extras\",\n\n\t\t\"export-view\":\"Download\",\n\t\t\"export-view-pdf\":\"PDF document\",\n\t\t\"export-view-png\":\"PNG image\",\n\t\t\"export-view-excel\":\"Excel file\",\n\n\t\t\"line-chart\":\"Line\",\n\t\t\"area-chart\":\"Area\",\n\t\t\"bar-chart\":\"Bar\",\n\t\t\"donut-chart\":\"Donut\",\n\t\t\"pie-chart\":\"Pie\",\n\t\t\"radar-chart\":\"Radar\",\n\t\t\"spline-chart\":\"Spline\",\n\t\t\"splinearea-chart\":\"Spline Area\",\n\n\t\t\"chart-axis\":\"Axis\",\n\t\t\"chart-scale\":\"Lines\",\n\t\t\"chart-scale-color\":\"Scale color\",\n\t\t\"chart-xAxis-title\":\"X axis title\",\n\t\t\"chart-yAxis-title\":\"Y axis title\",\n\t\t\"chart-col-xAxis\":\"Use left column as xAxis\",\n\t\t\"chart-row-xAxis\":\"Use top row as xAxis\",\n\t\t\"chart-xAxis-range\":\"xAxis range\",\n\n\t\t\"chart-legend\":\"Legend\",\n\t\t\"chart-row-legend\":\"Use top row as legend\",\n\t\t\"chart-col-legend\":\"Use left column as legend\",\n\t\t\"chart-legend-range\":\"Legend range\",\n\t\t\"chart-legend-align\":\"Align\",\n\t\t\"chart-legend-left\":\"Left\",\n\t\t\"chart-legend-right\":\"Right\",\n\t\t\"chart-legend-center\":\"Center\",\n\t\t\"chart-legend-valign\":\"Vertical align\",\n\t\t\"chart-legend-top\":\"Top\",\n\t\t\"chart-legend-middle\":\"Middle\",\n\t\t\"chart-legend-bottom\":\"Bottom\",\n\n\t\t\"chart-item\":\"Data\",\n\t\t\"stacked-chart\":\"Stacked\",\n\t\t\"chart-range\":\"Range\",\n\t\t\"chart-series-color\":\"Color\",\n\t\t\"add-line\":\"Add line\",\n\t\t\"chart-type\":\"Type\",\n\t\t\"chart-tooltip\":\"Tooltips\",\n\n\t\t\"chart-data-from\":\"Data series from\",\n\t\t\"chart-columns\":\"columns\",\n\t\t\"chart-rows\":\"rows\",\n\n\t\t\"chart-markers\":\"Markers\",\n\t\t\"chart-markers-square\":\"Square\",\n\t\t\"chart-markers-triangle\":\"Triangle\",\n\t\t\"chart-markers-diamond\":\"Diamond\",\n\t\t\"chart-markers-round\":\"Round\",\n\n\t\t\"chart-pie-text\":\"Show values inside\",\n\t\t\"chart-pie-3d\":\"3D\",\n\n\t\t\"chart-radar-circle\":\"Circled lines\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"ERROR\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\",\n\t\t\"parseDateTime\": \"%m/%d/%Y %G:%i:%s\",\n\t\t\"parseDate\": \"%m/%d/%Y\"\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css,  name: config.name, width: 68, value: \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\theight:202,\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t},\n\t$init:function(){\n\t\tthis.attachEvent(\"onSelect\", function(value){\n\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t});\n\t}\n}, webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\"\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tvalue = value || \"\";\n\t\tcolorboard.setValue(value);\n\t\tthis.config.value = value;\n\t\tthis.getColorNode().style.backgroundColor = value;\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t\tthis.config.close = true;\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpadding: webix.skin.$active.layoutPadding.form,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tif(webix.isUndefined(value.padding))\n\t\t\t\tvalue.padding = webix.skin.$active.layoutPadding.form;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tmove:true,\n\t\thead: \"Dialog\",\n\t\tbuttons: true,\n\t\tclose:true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t}\n\t\t}\n\t}\n}, webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","webix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tlet str1 = val.substring(0, cursor).match(/([a-zA-Z]+)$/);\n\t\t\tlet str2 = val.charAt(cursor).search(/[^A-Za-z0-9]/);\n\n\t\t\tif(str1 && (cursor === val.length || str2 === 0))\n\t\t\t\tvalue = str1[0];\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onAfterFilter\", view: \"cells\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (var i=1; i<1000; i++){\n\tvar prefixIndex = parseInt((i-1)/alpha.length);\n\tvar str = (prefixIndex?alpha[prefixIndex-1]:\"\")+alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tvar size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tvar col = text.substr(0, size);\n\tvar row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view){\n\tvar nind = text.indexOf(\"!\");\n\tvar sheet = \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tvar parts = text.split(\":\");\n\tif (parts.length != 2 && view){\n\t\ttext = view.ranges.getCode(text, sheet);\n\t\tif (!text) return null;\n\t\tparts = text.split(\":\");\n\t} \n\n\tvar d1 = adress(parts[0]);\n\tvar d2 = adress(parts[1]);\n\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nvar notAlphaNum = /[^A-Za-z0-9]/;\nfunction escapeSheet(text){\n\tif (notAlphaNum.test(text))\n\t\treturn `'${text}'`;\n\treturn text;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tlet a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tvar range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nvar rangeTest = /(([A-Za-z0-9]+|'[^']+')!|)[A-Z]+[0-9]+:[A-Z]+[0-9]+/;\nexport function isRange(text){\n\treturn rangeTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"middle\",\n\t\"white-space\": \"nowrap\",\n\t\"format\": \"common\"\n};\n\nexport function setSkinDefaults(){\n\tconst material = webix.skin.$name == \"material\" || webix.skin.$name == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"text-align\": {\n\t\tleft: () => \"justify-content:flex-start;\",\n\t\tcenter: () => \"justify-content:center;\",\n\t\tright: () => \"justify-content:flex-end;\"\t\t\n\t},\n\t\"vertical-align\": {\n\t\ttop: () => \"align-items:flex-start;\",\n\t\tmiddle: () => \"align-items:center;\",\n\t\tbottom: () => \"align-items:flex-end;\"\n\t},\n\twrap: {\n\t\twrap: ()=> {\n\t\t\treturn \"white-space: normal !important;\";\n\t\t}\n\t},\n\t\"border-left\": obj => {\n\t\tif(obj[\"border-left\"])\n\t\t\treturn \"border-left: 1px solid \"+obj[\"border-left\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-top\":obj => {\n\t\tif(obj[\"border-top\"])\n\t\t\treturn \"border-top: 1px solid \"+obj[\"border-top\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-right\": obj => {\n\t\tif(obj[\"border-right\"])\n\t\t\treturn \"border-right: 1px solid \"+obj[\"border-right\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-bottom\": obj => {\n\t\tif(obj[\"border-bottom\"])\n\t\t\treturn \"border-bottom: 1px solid \"+obj[\"border-bottom\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"font-weight\": obj => {\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t}\n};\n\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tvar area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tvar type = value[0];\n\t\tvar color = value[1];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"no\")\n\t\t\tcolor = \"\";\n\t\telse if(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\t\t\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type))\n\t\t\t\tstyle = _updateStyle(view, style, mode, color, cell);\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; height:auto;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tvar styles = view.getRow(cell.row).$cellCss;\n\tif (styles){\n\t\tvar styleid = styles[cell.column];\n\t\tif (styleid)\n\t\t\treturn view._styles[styleid];\n\t}\n\treturn null;\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:_styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\t\t\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: _styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\t//this - spreadsheet\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst item = view.getRow(row);\n\n\titem.$cellCss = item.$cellCss || {};\n\titem.$cellFormat = item.$cellFormat || {};\n\n\tif(style){\n\t\titem.$cellCss[column] = style.id;\n\t\titem.$cellFormat[column] = style.props.format || null;\n\t} else {\n\t\tdelete item.$cellCss[column];\n\t\tdelete item.$cellFormat[column];\n\t}\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, baseWidth){\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = baseWidth ? baseWidth+\"px\" : \"auto\";\n\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\tconst width = Math.max(0, sizeEl.offsetWidth+1);\n\tconst height = Math.max(0, sizeEl.offsetHeight+1);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width, height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tgroup.set(()=>{\n\t\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\t\tconst format = style && style.props.format || null;\n\t\t\tconst oldFormat = old && old.props.format || null;\n\t\t\tconst formatChanged = format != oldFormat;\n\t\t\tif(!formatChanged || formatChanged && view.callEvent(\"onBeforeFormatChange\", [cell.row, cell.column, format, oldFormat])){\n\t\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\n\t\t\t\tif(formatChanged)\n\t\t\t\t\tview.callEvent(\"onFormatChange\", [cell.row, cell.column, format, oldFormat]);\n\n\t\t\t\tview.saveCell(cell.row,cell.column);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nfunction _styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tlet params  = view.serialize();\n\n\tlet data = params.data;\n\tlet styles = params.styles;\n\n\tlet used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tlet name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tlet newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tlet name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\tparams.styles = newStyles;\n\treset(view);\n\t_parse(view, params);\n}","import {addStyle} from \"./styles\";\nimport {getJsDateFromExcel} from \"../math/methods/helpers\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\tconst defaultFormats = [\"percent\", \"int\", \"price\", \"date\", \"string\"];\n\n\tfor(let i in formatSources){\n\t\tif(defaultFormats.indexOf(i) == -1) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tcreateFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction createFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tvalues = webix.extend(\n\t\ttypeof(values) == \"object\" ? values : { format:str, type:\"custom\" }, \n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:createFormatName(format, type) }, old);\n\tview.setStyle(row, column, nev);\n}\n\nexport function removeFormat(view, row, column){\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:\"\" }, old);\n\tview.setStyle(row, column, nev);\n}\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n}\n\nfunction genCode(check, color, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tconst typesOrder = [\n\t\t{name:\"date\", order:dateOrder, types:dateTypes}, \n\t\t{name:\"time\", order:timeOrder, types:timeTypes}\n\t];\n\n\t// \"m\"/\"mm\" format can be either date (%n/%m) or time (%i), so check last date type\n\tconst basedOnLast = /^m{1,2}(?!m)/.test(text);\n\tif(basedOnLast && lastDateType != \"date\")\n\t\ttypesOrder.reverse();\n\n\tfor(let i = 0; i < typesOrder.length; i++){\n\t\tconst type = typesOrder[i];\n\t\tfor(let j = 0; j < type.order.length; j++)\n\t\t\tif(text.indexOf(type.order[j]) == 0)\n\t\t\t\treturn {\n\t\t\t\t\tformat: type.types[type.order[j]],\n\t\t\t\t\tlength: type.order[j].length,\n\t\t\t\t\ttype: type.name\n\t\t\t\t};\n\t}\n}\n\nfunction genFormatCode(line, delimiters){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? `val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst item = view.$$(\"cells\").getItem(cells[0].row)[cells[0].column];\n\tconst firstValue = item ? item.toString() : item;\n\tconst firstStyle = view.getStyle(cells[0].row, cells[0].column);\n\n\tif(webix.rules.isNumber(firstValue) || (firstStyle && firstStyle.props.format)){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tlet format = view.getStyle(cells[0].row, cells[0].column).props.format || \"common\";\n\t\tformat = isCustom(format) ? \"custom\" : format;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst style = view.getStyle(cell.row, cell.column);\n\tlet value = view.$$(\"cells\").getItem(cell.row)[cell.column];\n\tvalue = value ? value.toString() : \"\";\n\n\tif(style && style.props.format){\n\t\tconst name = style.props.format;\n\t\tformat = webix.copy({values:formatHelpers[name].values, format:getFormatSource(name)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\tif(formValues.negative == 4)\n\t\tvalues[1].left.text += \"(\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text += \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbol = formatHelpers.price.values.symbol;\n\t\tconst right = symbol.indexOf(\" \") == 0;\n\n\t\tvalues[1][right?\"right\":\"left\"].text += symbol;\n\t\tvalues[0][right?\"right\":\"left\"].text += symbol;\n\t}\n\n\tif(formValues.negative == 4)\n\t\tvalues[1].right.text += \")\";\n\n\treturn values;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition, left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet start = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color:color, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(format, type, checkTime){\n\tformat = format && format.fmt ? format.fmt : getFormatSource(format);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i), \"date\");\n\t\t\t\tif(datePart){\n\t\t\t\t\tif(checkTime){\n\t\t\t\t\t\tif(datePart.type == \"time\")\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}\n\nexport function getFormatName(view, row, col){\n\tconst item = view.getRow(row);\n\treturn item && item.$cellFormat && item.$cellFormat[col];\n}\n\nexport function isDateInvalid(value){\n\treturn value < -99974430.925 || value > 100025569.125;\n}\n\nexport function getDateEditFormat(item, col){\n\tconst formatName = item.$cellFormat[col];\n\tconst locale = webix.i18n.spreadsheet.formats;\n\tconst isTime = checkFormat(formatName, \"date\", true);\n\n\treturn webix.Date.dateToStr( locale[isTime ? \"parseDateTime\" : \"parseDate\"] );\n}","import {getFormatName, getFormatSource} from \"../operations/formats\";\n\nfunction isChar(char){\n\tvar code = char.charCodeAt(0);\n\t// #(35) - errors like #REF!, $(36) - absolute cell reference, a-zA-Z(65-122) - chars\n\treturn (code>=65 && code<=122) || code == 35 || code == 36;\n}\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nfunction errorCode(e){\n\treturn `this.e(\"${e}\")`;\n}\n\nfunction operandCode(deps, word, sheet){\n\tlet [r,c] = position(word);\n\n\tif (sheet !== \"\"){\n\t\tdeps.push([r,c,r,c,sheet]);\n\t\treturn `this.vs(\"${sheet}\",${r},${c})`;\n\t} else {\n\t\tdeps.push([r,c,r,c,\"\"]);\n\t\treturn `this.v(${r},${c})`;\n\t}\n}\n\nfunction methodCode(word){\n\treturn `this.m.${word}`;\n}\n\nfunction namedRangeCode(deps, view, word, sheet){\n\tvar code  = view.ranges.getCode(word, sheet);\n\tif(!code) return \"\";\n\n\tvar sheetInd = code.indexOf(\"!\");\n\tif (sheetInd !== -1){\n\t\tsheet = code.substr(0, sheetInd);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\tcode = code.substr(sheetInd+1);\n\t}\n\n\tlet [a,b] = code.split(\":\");\n\treturn rangeCode(deps, a, b, sheet);\n}\n\nfunction templateCode(word){\n\treturn `this.p.${word}`;\n}\n\nfunction rangeCode(deps, a, b, sheet){\n\tlet [r1,c1] = position(a);\n\tlet [r2,c2] = position(b);\n\n\tif (r1>r2) { let t=r1; r1=r2; r2=t; }\n\tif (c1>c2) { let t=c1; c1=c2; c2=t; }\n\t\n\tif (sheet === \"\"){\n\t\tdeps.push([r1,c1,r2,c2,\"\"]);\n\t\treturn `this.r(${r1},${c1},${r2},${c2})`;\n\t} else {\n\t\tdeps.push([r1,c1,r2,c2, sheet]);\n\t\treturn `this.rs(\"${sheet}\",${r1},${c1},${r2},${c2})`;\n\t}\n}\n\nexport function split(formula, crosssheet, ranges){\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (!sheet || (!crosssheet && sheet)){\n\t\t\t\t\t\tif(sheet){\n\t\t\t\t\t\t\t// 'sheet'! - 3 extra symbols, sheet! - 1 extra symbol\n\t\t\t\t\t\t\ti += sheet.length + (escaped ? 3 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (formula[next+1] !== \"(\" && (isPosition(word) || (ranges && ranges[word]))){\n\t\t\t\t\t\t\tvalue = crosssheet ? word : position(word);\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if(crosssheet){\n\t\t\t\t\t\tvalue = [sheet, word, escaped];\n\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function parse(formula, view, passive = \"\"){\n\tvar code =\"return \";\n\tvar deps = [];\n\n\tvar quotes = false;\n\tvar pair = \"\", pairsheet = \"\";\n\n\tif (formula[0] != \"=\") return false;\n\n\tfor (var i = 1; i < formula.length; i++){\n\t\tvar key = formula[i];\n\n\t\tif (key == \"\\\"\")\n\t\t\tquotes = !quotes;\n\t\telse if (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\tlet [word, end] = getWord(formula, i+2);\n\t\t\ti = end + 1;\n\t\t\tcode += templateCode(word);\n\t\t\tcontinue;\n\t\t}\n\t\telse if (!quotes && (key == \"'\" || isChar(key))){\n\t\t\tlet [rawword, end, start, sheet] = getWord(formula, i, passive);\n\n\t\t\t//lower case formulas, fix them\n\t\t\tlet word = rawword.toUpperCase();\n\n\t\t\ti = end - 1;\n\n\t\t\t//errors like #REF!\n\t\t\tif(word[0] == \"#\"){\n\t\t\t\tcode += errorCode(word);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (formula[i+1] == \"(\"){\n\t\t\t\tcode += methodCode(word);\n\t\t\t}\n\t\t\telse if (isPosition(word)){\n\t\t\t\tif (formula[i+1] == \":\"){\n\t\t\t\t\tpair = word; pairsheet = sheet;\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\tif (pair !== \"\"){\n\t\t\t\t\t\tcode += rangeCode(deps, pair, word, pairsheet);\n\t\t\t\t\t\tpair = \"\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst cell = operandCode(deps, word, sheet);\n\t\t\t\t\t\tif(formula[end] == \"+\")\n\t\t\t\t\t\t\tcode += `(isNaN(${cell} * 1) ? ${cell} : ${cell} * 1)`;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcode += cell;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet range = namedRangeCode(deps, view, word, sheet);\n\t\t\t\t//we have some error word in a formula\n\t\t\t\t//break from loop to skip formula updating\n\t\t\t\tif (range == \"\"){\n\t\t\t\t\tcode += errorCode(\"#REF!\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += range;\n\t\t\t}\n\n\t\t\t//operator, or range, or parameter\n\t\t\tif (word !== rawword){\n\t\t\t\tformula = formula.substr(0, start)+word+formula.substr(end);\n\t\t\t}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\t//special handling for & operator, string concat\n\t\t\tif (key === \"&\" && formula[i+1] !== \"&\")\n\t\t\t\tcode += \"+\\\"\\\"+\";\n\t\t\t//convert <> to !=\n\t\t\telse if (key === \"<\" && formula[i+1] === \">\"){\n\t\t\t\tcode += \"!=\";\n\t\t\t\ti++;\n\t\t\t//convert = to ==\n\t\t\t} else if (key === \"=\" && formula[i-1] !== \"<\" && formula[i-1] !== \">\")\n\t\t\t\tcode += \"==\";\n\t\t\telse\n\t\t\t\tcode += key;\n\t\t} else\n\t\t\tcode += key;\n\t}\n\n\n\treturn { code: code+\";\", triggers:deps, text: formula };\n}\n\nexport function getMathFormat(view, value){\n\tlet level = 0;\n\tlet blockLevel;\n\tconst ranges = view.ranges._ranges;\n\tconst parts = split(value, true, ranges);\n\n\tfor(let i = 0; i < parts.length; i++){\n\t\t// parts[i] can contain numbers, math operators, formulas, etc.\n\t\tif(i%2 === 0){\n\t\t\t// check formulas and round brackets which are not in quotes\n\t\t\tconst methods = parts[i].match(/(([a-zA-Z]*\\()|\\))(?=(?:[^\"]|\"[^\"]*\")*$)/g);\n\t\t\tif(methods)\n\t\t\t\tmethods.forEach(part => {\n\t\t\t\t\tif(part.indexOf(\"(\") > -1){\n\t\t\t\t\t\tlevel++;\n\t\t\t\t\t\t// some methods block format addition (like count,odd,etc.)\n\t\t\t\t\t\tconst safeMethods = /^(SUM|AVERAGE|MAX|MIN|INT|ROUND|ROUNDDOWN|ROUNDUP|TRUNC)?\\($/gi;\n\t\t\t\t\t\tif(!blockLevel && !safeMethods.test(part))\n\t\t\t\t\t\t\tblockLevel = level;\n\t\t\t\t\t}\n\t\t\t\t\telse if(--level < blockLevel)\n\t\t\t\t\t\tblockLevel = null;\n\t\t\t\t});\n\t\t}\n\t\t// parts[i] can be named range, cell from the active / non-active sheet\n\t\telse if(!blockLevel){\n\t\t\tif(webix.isArray(parts[i])){\n\t\t\t\tif(parts[i][0] == view.getActiveSheet())\n\t\t\t\t\tparts[i] = parts[i][1];\n\t\t\t\telse\n\t\t\t\t\tcontinue; // ignore non-active sheets\n\t\t\t}\n\n\t\t\t// if range - check first cell position\n\t\t\tconst cell = /^[A-Za-z]+$/.test(parts[i]) ? position(ranges[parts[i]].split(\":\")[0]) : position(parts[i]);\n\t\t\tconst name = getFormatName(view, cell[0], cell[1]);\n\n\t\t\t// first cell with number format\n\t\t\tif(name)\n\t\t\t\treturn {fmt: getFormatSource(name)};\n\t\t}\n\t}\n}","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import \"./suggest_formula\";\nimport {split, position} from \"../math/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code === 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tthis.showActiveSheet();\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t\twebix.delay(()=>{\n\t\t\t\t\t\tthis.getTopParentView()._table.moveSelection(\"down\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst ranges = master.ranges._ranges;\n\t\t\tconst parts = split(value, true, ranges);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif(i%2 === 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = /^[A-Za-z]+$/.test(parts[i]);\n\t\t\t\t\tif(activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = ranges[parts[i]].split(\":\");\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(crossheet ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = crossheet ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? parts[i] : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(){\n\t\tconst master = this.getTopParentView();\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst val = this.getValue();\n\n\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tmaster._table.select(cell.row, cell.column);\n\t\t\t\t\tthis.setValue(val);\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tlet code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && this.getValue().charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue(){\n\t\tlet master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tlet cell = this.config.activeCell;\n\t\t\tlet node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = `<div>${webix.template.escape(this.getValue())}</div>`;\n\t\t}\n\t},\n\tupdateCellValue() {\n\t\tlet newv = this.getValue();\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse{\n\t\t\tlet val = master.getCellValue(cell.row, cell.column);\n\n\t\t\tif(newv != val){\n\t\t\t\tthis.config.value = newv;\n\t\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\t\tmaster.refresh();\n\t\t\t}\n\t\t}\n\n\t\tdelete master.$handleSelection;\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\n\t\t\tconst updatedStr = /[a-zA-Z]+\\(?$/.test(str1) ? str1.replace(/[a-zA-Z]+\\(?$/, value) : str1 + value;\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 = updatedStr + (str2[0] == \"(\" ? \"\" : \"(\");\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectRange(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn last.match(/[(,]/);\n\t},\n\texpectOperator(){\n\t\tlet text = this.getValue();\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\treturn text[0] == \"=\" && text[cursor-1] && text[cursor-1].match(/[+&\\-/*%=(:,]/);\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);\n\n\n// toolbar: silent toggle button\nwebix.protoUI({\n\tname:\"ssheet-toggle-silent\",\n\t$cssName:\"toggle\",\n\t$allowsClear:false,\n\tsetValue:function(){\n\t\tthis.blockEvent();\n\t\twebix.ui.toggle.prototype.setValue.apply(this, arguments);\n\t\tthis.unblockEvent();\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst count = this.getValue().length;\n\t\t\t\tthis.elements.$all.setValue(count == this._count ? 1 : 0);\n\t\t\t\tif(!count)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: sheet.name, name: sheet.name, value: sheet.active});\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue())\n\t\t\t\toutput.push(checkboxes[i].config.name);\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-ui\",\n\tdefaults:{\n\t\tmove:true,\n\t\tcss:\"webix_shadow_none webix_ssheet_ui\",\n\t\thead:false,\n\t\tresize:true,\n\t\ttoFront:true,\n\t\tminWidth:50,\n\t\tminHeight:200,\n\t\tescHide:false,\n\t\tautofit:false\n\t},\n\t$init:function(){\n\t\t// prevent block selection\n\t\tthis.$view.setAttribute(\"webixignore\", \"1\");\n\n\t\tthis.$ready.push(function(){\n\t\t\twebix.UIManager.addHotKey(\"delete\", webix.bind(this._removeView, this));\n\t\t\twebix.UIManager.addHotKey(\"backspace\", webix.bind(this._removeView, this));\n\t\t\tthis.getMenu();\n\t\t});\n\t\tthis.attachEvent(\"onDestruct\", function(){\n\t\t\twebix.eventRemove(this._clickEv);\n\t\t\tthis._menu.destructor();\n\t\t});\n\t},\n\tmove_setter:function(value){\n\t\tif (value){\n\t\t\twebix.DragControl.addDrag(this.$view, this);\n\t\t}\n\t\treturn value;\n\t},\n\t$dragPos:function(pos, e){\n\t\tthis.callEvent(\"onViewMove\", [pos, e]);\n\t\treturn pos;\n\t},\n\t$dragCreate:function(object, e){\n\t\tconst trg = e.target;\n\t\tif (!trg.getAttribute || trg.getAttribute(\"webix_disable_drag\") || trg.getAttribute(\"webixignore\"))\n\t\t\treturn;\n\n\t\tthis.getMenu().hide();\n\t\tconst elOffset = webix.html.offset(object);\n\t\tconst elPos = webix.html.pos(e);\n\t\tconst pOffset = webix.html.offset(object.parentNode);\n\t\tconst state = webix.$$(this.config.master).getScrollState();\n\n\t\twebix.DragControl.top = elOffset.y - elPos.y - pOffset.y;\n\t\twebix.DragControl.left = elOffset.x - elPos.x - pOffset.x + state.x;\n\n\t\treturn webix.toNode(this.$view);\n\t},\n\t$dragDestroy:function(node, drag){\n\t\tconst x = this.config.left = parseInt(drag.style.left,10);\n\t\tconst y = this.config.top = parseInt(drag.style.top,10);\n\n\t\twebix.DragControl.top = webix.DragControl.left = 0;\n\n\t\tthis.callEvent(\"onViewMoveEnd\", [x, y]);\n\t\treturn;\n\t},\n\tgetMenu:function(){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tif(!this._menu){\n\t\t\tlet data = [\n\t\t\t\t{ value:labels[\"export-view\"], submenu:[\n\t\t\t\t\t{ id:\"pdf\", value:labels[\"export-view-pdf\"] },\n\t\t\t\t\t{ id:\"png\", value:labels[\"export-view-png\"] },\n\t\t\t\t\t{ id:\"excel\", value:labels[\"export-view-excel\"] }\n\t\t\t\t] }\n\t\t\t];\n\n\t\t\tif(!webix.$$(this.config.master).getTopParentView().config.readonly)\n\t\t\t\tdata = [\n\t\t\t\t\t{ id:\"edit\", value:labels[\"edit-view\"] },\n\t\t\t\t\t...data,\n\t\t\t\t\t{ id:\"del\", value:labels[\"remove-view\"] }\n\t\t\t\t];\n\n\t\t\tthis._menu = webix.ui({\n\t\t\t\tview:\"contextmenu\",\n\t\t\t\tdata:data,\n\t\t\t\ton:{\n\t\t\t\t\tonMenuItemClick: id => this._menuActions(id),\n\t\t\t\t\tonBeforeShow: () => this._toggleExcel()\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst dots = webix.html.create(\"span\", {\"class\":\"webix_ssheet_view_menu webix_icon wxi-dots\"});\n\t\t\tthis._clickEv = webix.event(dots, \"click\", ()=> {\n\t\t\t\tif(this._menu.isVisible())\n\t\t\t\t\tthis._menu.hide();\n\t\t\t\telse\n\t\t\t\t\tthis._menu.show(dots);\n\t\t\t});\n\t\t\tthis.$view.firstChild.appendChild(dots);\n\t\t}\n\t\treturn this._menu;\n\t},\n\t_menuActions:function(id){\n\t\tswitch(id){\n\t\t\tcase \"del\":\n\t\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"edit\":\n\t\t\t\tthis.callEvent(\"onViewEdit\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"pdf\":\n\t\t\t\twebix.toPDF(this.getBody(), {display:\"image\"});\n\t\t\t\tbreak;\n\t\t\tcase \"png\":\n\t\t\t\twebix.toPNG(this.getBody());\n\t\t\t\tbreak;\n\t\t\tcase \"excel\":\n\t\t\t\twebix.toExcel(this.getBody(), {header: false});\n\t\t\t\tbreak;\n\t\t}\n\t},\n\t_toggleExcel:function(){\n\t\tconst view = this.getBody();\n\t\tif(view.data && view.data.pull)\n\t\t\tthis._menu.showItem(\"excel\");\n\t\telse\n\t\t\tthis._menu.hideItem(\"excel\");\n\t},\n\t_removeView:function(view){\n\t\tif(view && view.getTopParentView() == this)\n\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname: \"ssheet-series\",\n\t$init: function(config){\n\t\tconfig.rows = [\n\t\t\t{\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tborderless: true,\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\tmulti: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.getSectionConfig()\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonAfterScroll:function(){\n\t\t\t\t\t\t//close possibly open selector popups\n\t\t\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ view:\"button\", label:webix.i18n.spreadsheet.labels[\"add-line\"], click:()=>{\n\t\t\t\tthis.addSection();\n\t\t\t}}\n\t\t];\n\t},\n\tgetSectionConfig: function(i){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tconst trashIcon = \"<span class='webix_icon webix_ssheet_series_icon wxi-trash'></span>\";\n\t\tconst padding = webix.skin.$active.dataPadding-2;\n\n\t\treturn {\n\t\t\tview:\"accordionitem\",\n\t\t\theader:`${labels[\"chart-item\"]} ${i ? i+1 : 1} ${trashIcon}`,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\tpadding,\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\", range:true, on:{\n\t\t\t\t\t\tonChange: (val, oldVal) => {\n\t\t\t\t\t\t\tthis.callEvent(\"onRangeChange\", [val, oldVal]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-series-color\"], name:\"color\"},\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-tooltip\"], name:\"tooltip\" },\n\t\t\t\t\t{ view:\"richselect\", label:labels[\"chart-markers\"], value:\"square\", name:\"marker\", hidden: !this.markersVisible,\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{id:\"square\", value:labels[\"chart-markers-square\"]},\n\t\t\t\t\t\t\t\t{id:\"triangle\", value:labels[\"chart-markers-triangle\"]},\n\t\t\t\t\t\t\t\t{id:\"diamond\", value:labels[\"chart-markers-diamond\"]},\n\t\t\t\t\t\t\t\t{id:\"round\", value:labels[\"chart-markers-round\"]}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tonClick:{\n\t\t\t\t\"wxi-trash\": function(){\n\t\t\t\t\tconst layout = this.getParentView();\n\t\t\t\t\tlayout.removeView(this);\n\n\t\t\t\t\tconst childs = layout.getChildViews();\n\n\t\t\t\t\tfor (let i = 0; i < childs.length; i++) {\n\t\t\t\t\t\tchilds[i].define({header:`${labels[\"chart-item\"]} ${i+1} ${trashIcon}`});\n\t\t\t\t\t\tchilds[i].refresh();\n\t\t\t\t\t}\n\n\t\t\t\t\tlayout.getParentView().getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\taddSection: function(){\n\t\tconst layout = this.getLayout();\n\t\tconst lastIndex = layout.getChildViews().length;\n\t\tconst layoutId = layout.addView(this.getSectionConfig(lastIndex));\n\n\t\twebix.$$(layoutId).queryView({name: \"range\"}).focus();\n\t},\n\tsetValue: function(value){\n\t\tvalue = value || [];\n\n\t\tconst layout = this.getLayout();\n\t\tconst childs = layout.getChildViews();\n\t\tconst count = childs.length;\n\n\t\tif(count > value.length)\n\t\t\tfor(let i = count; i > value.length; i--)\n\t\t\t\tthis.getLayout().removeView(childs[i-1]);\n\t\telse if(value.length > count)\n\t\t\tfor(let i = value.length; i > count; i--)\n\t\t\t\tthis.addSection();\n\n\t\tfor(let i = 0; i < childs.length; i++){\n\t\t\tconst form = childs[i].getChildViews()[0];\n\t\t\tconst range = form.queryView({name: \"range\"});\n\n\t\t\t//block range events to ignore onRangeChange\n\t\t\trange.blockEvent();\n\t\t\tform.setValues(value[i]);\n\t\t\trange.unblockEvent();\n\t\t}\n\t},\n\tsetSubValue: function(sub, value){\n\t\tsub.blockEvent();\n\t\tsub.setValue(value);\n\t\tsub.unblockEvent();\n\t},\n\tgetLayout(){\n\t\treturn this.queryView(\"scrollview\").getBody();\n\t},\n\thideMarkers: function(show){\n\t\tthis.markersVisible = show;\n\t\tthis.queryView(\"richselect\", \"all\").forEach(marker => {\n\t\t\tif(show)\n\t\t\t\tmarker.show();\n\t\t\telse\n\t\t\t\tmarker.hide();\n\t\t});\n\t},\n\tgetValue: function(){\n\t\tconst value = [];\n\n\t\tconst layout = this.getLayout();\n\t\tlayout.getChildViews().forEach(child => {\n\t\t\tvalue.push(child.getChildViews()[0].getValues());\n\t\t});\n\t\treturn value;\n\t}\n}, webix.ui.layout);","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nwebix.editors.excel_date = webix.extend({\n\tcreatePopup:function(){\n\t\tconst editor = webix.editors.excel_date;\n\n\t\tif(!editor.popup){\n\t\t\tconst popup = webix.ui({\n\t\t\t\tview:\"popup\",\n\t\t\t\tbody:{ \n\t\t\t\t\tview:\"calendar\",\n\t\t\t\t\ticons:true,\n\t\t\t\t\ttimepicker:true,\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonChange: function(val){\n\t\t\t\t\t\t\tval = val[0];\n\t\t\t\t\t\t\tthis.getParentView()._last_input_target.value = val ? getExcelDateFromJs(val) : \"\";\n\t\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonEnter: function(){\n\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditor.popup = popup.config.id;\n\t\t}\n\n\t\treturn editor.popup;\n\t},\n\trender:function(){\n\t\tconst node = webix.html.create(\"div\", {\n\t\t\t\"class\":\"webix_dt_editor\"\n\t\t}, \"<input type='text'>\");\n\n\t\tthis.popup = this.createPopup();\n\n\t\twebix.event(node.firstChild, \"click\", ()=> this.getPopup().show(node));\n\n\t\treturn node;\n\t},\n\tgetPopup(){\n\t\treturn webix.$$(this.popup);\n\t},\n\tshowPopup:function(){\n\t\tconst input = this.getInputNode();\n\t\tconst popup = this.getPopup();\n\n\t\tpopup._last_input_target = input;\n\t\tpopup.show(input);\n\n\t\tinput.setAttribute(\"aria-expanded\", \"true\");\n\t},\n\tupdateCalendar(value){\n\t\tconst calendar = this.getPopup().getBody();\n\n\t\tcalendar.blockEvent();\n\t\tcalendar.setValue(value);\n\t\tcalendar.unblockEvent();\n\t},\n\tafterRender:function(){\n\t\tthis.showPopup();\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\tthis.updateCalendar(value);\n\n\t\tconst format = getDateEditFormat(this.config.row, this.config.id);\n\t\tthis.getInputNode().value = format(value);\n\t},\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().value;\n\t\tthis.getPopup().hide();\n\t\treturn value;\n\t}\n}, webix.editors.text);","webix.editors.ss_richselect = webix.extend({\n\tgetFormat:function(value){\n\t\tconst list = this.getInputNode();\n\t\tlet item;\n\n\t\tif (value && list.exists(value))\n\t\t\titem = list.getItem(value);\n\t\treturn item && item.format;\n\t},\n\tpopupInit:function(popup){\n\t\twebix.editors.richselect.popupInit.apply(this, arguments);\n\n\t\tpopup.getList().define(\"template\", function(obj){\n\t\t\treturn obj.$value || obj.value;\n\t\t});\n\t}\n}, webix.editors.richselect);","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ttoggleButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle-silent\", width: toolbarSizes.width, id: config.name, name: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue:\"wrap\", offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"image\":function(){\n\t\treturn {\n\t\t\tname:\"image\", view:\"ssheet-button\", icon:\"add-image\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-image-cell\", value: webix.i18n.spreadsheet.labels[\"add-image-cell\"]},\n\t\t\t\t{id:\"add-image-top\", value: webix.i18n.spreadsheet.labels[\"add-image-top\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"graph\":function(){\n\t\treturn {\n\t\t\tname:\"graph\", view:\"ssheet-button\", icon:\"add-sparkline\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-sparkline\", value:webix.i18n.spreadsheet.labels[\"add-sparkline\"]},\n\t\t\t\t{id:\"add-chart\", value: webix.i18n.spreadsheet.labels[\"add-chart\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t},\n\t\"create-filter\": function(){\n\t\treturn ui.toggleButton({name: \"create-filter\"});\n\t},\n\t\"hide-gridlines\": function(){\n\t\treturn ui.toggleButton({name: \"hide-gridlines\"});\n\t},\n\t\"hide-headers\": function(){\n\t\treturn ui.toggleButton({name: \"hide-headers\"});\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"graph\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"toolbar-update\")\n\t\t\tupdateValue(view, action.name, action.value);\n\t});\n\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tconst barStyles = getBarStyles(view, selected);\n\tview.$$(\"bar\").setValues(barStyles);\n}\n\nfunction updateValue(view, name, value){\n\tconst element = view.$$(\"bar\").elements[name];\n\n\tif (element)\n\t\telement.setValue(value);\n}\n\nfunction getBarStyles(view, selected){\n\tconst dropdowns = [\n\t\t\"font-family\",\n\t\t\"font-size\",\n\t\t\"text-align\",\n\t\t\"vertical-align\",\n\t\t\"format\",\n\t\t\"background\",\n\t\t\"color\"\n\t];\n\n\tconst cell = selected[0];\n\tconst barStyles = getCellStyles(view, cell);\n\n\tfor(let i = 1; i < selected.length; i++){\n\t\tconst cellStyle = getCellStyles(view, selected[i]);\n\n\t\tfor(let k = dropdowns.length-1; k >= 0; k--){\n\t\t\tconst property = dropdowns[k];\n\t\t\tif(barStyles[property] != cellStyle[property]){\n\t\t\t\tdelete barStyles[property];\n\t\t\t\tdropdowns.splice(k, 1);\n\t\t\t}\n\t\t}\n\n\t\tif(!dropdowns.length)\n\t\t\tbreak;\n\t}\n\n\treturn barStyles;\n}\n\nfunction getCellStyles(view, cell){\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span)\n\t\t[cell.row, cell.column] = span;\n\n\tconst obj = view.getStyle(cell.row, cell.column);\n\tconst styles = obj ? webix.copy(obj.props) : {};\n\n\tfor (let i in defaultStyles)\n\t\tif(!styles[i])\n\t\t\tstyles[i] = defaultStyles[i];\n\n\tstyles.format = isCustom(styles.format) ? \"custom\" : styles.format;\n\n\treturn styles;\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\tconst columnWidth = view._table.getColumnConfig(column).width;\n\n\tview._table.eachRow(function(row) {\n\t\tconst span = view._table.getSpan(row, column);\n\t\tif(span && span[2] > 1)\n\t\t\treturn;\n\n\t\tconst text = this.getText(row, column);\n\t\tconst style = view.getStyle(row, column);\n\t\tconst css = style ? style.id : \"\";\n\n\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\tconst size = getTextSize(view, text, css);\n\n\t\t\tif(view.getCellEditor(row, column) || view.getCellFilter(row, column))\n\t\t\t\tsize.width += 20;\n\t\t\tif(style && style.props.wrap == \"wrap\" && size.width > columnWidth)\n\t\t\t\tsize.width = columnWidth;\n\t\t\tif (size.width > width)\n\t\t\t\twidth = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\n\tview._table.eachColumn(function(column) {\n\t\tif(column != \"rowId\"){\n\t\t\tconst text = this.getText(row, column);\n\t\t\tlet width = this.getColumnConfig(column).width;\n\n\t\t\tconst span = view._table.getSpan(row, column);\n\t\t\tif(span)\n\t\t\t\twidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\tlet style = view.getStyle(row, column);\n\t\t\tlet css = style ? style.id : \"\";\n\n\t\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\t\tlet size = getTextSize(view, text, css, width);\n\t\t\t\tif (size.height > height) height = size.height;\n\t\t\t}\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start,end, view){\n\tif(!view._table.config.header) return;\n\n\tconst css = \"webix_highlight\";\n\n\tlet sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tview._table.eachRow(function(row){\n\t\tif(row < sr || row > er)\n\t\t\tview._table.removeCellCss(row, \"rowId\", css);\n\t\telse\n\t\t\tview._table.addCellCss(row, \"rowId\", css);\n\t});\n\n\tview._table.eachColumn(function(col){\n\t\tconst node = view._table.getHeaderNode(col);\n\t\tif(col == \"rowId\" || !node) return;\n\n\t\tif(col < sc || col > ec)\n\t\t\twebix.html.removeCss(node, css);\n\t\telse\n\t\t\twebix.html.addCss(node, css, true);\n\t});\n}","import * as cop from \"./operations/column_operations\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\tminColumnWidth:38,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\t//enable clipboard by default\n\tif (extra.clipboard !== false){\n\t\textra.clipboard = \"custom\";\n\t\tif(extra.clipboardDecimalDelimiter)\n\t\t\textra.templateCopy = function(item) {\n\t\t\t\tif(webix.rules.isNumber(item))\n\t\t\t\t\titem = item.toString().replace(\".\", extra.clipboardDecimalDelimiter);\n\t\t\t\treturn item;\n\t\t\t};\n\t}\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showCommentHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column drag event checking\n\tlet dragStartColumn;\n\tlet dragEndColumn;\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif (finalStep &&\n\t\t(start.column !== \"rowId\" || end.column !== \"rowId\")) {\n\t\t\tif (start.column === \"rowId\") start.column = 1;\n\t\t\tif (end.column === \"rowId\") end.column = 1;\n\t\t}\n\t\tif(start.column !== \"rowId\" || end.column !== \"rowId\"){\n\t\t\tcop.highlightColRow(start,end, view);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n\n\tfunction highlightHeaders(){\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t}\n\t\telse {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t}\n\n\tgrid.attachEvent(\"onSelectChange\", () => highlightHeaders());\n\tgrid.attachEvent(\"onColumnResize\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousedown\", e => {\n\t\tconst resizeColumn = grid.config.resizeColumn;\n\t\tconst col = grid.locate(e);\n\n\t\tif(col && col.cind){\n\t\t\tif(resizeColumn){\n\t\t\t\tconst dx = grid.getColumnConfig(col.column).width;\n\t\t\t\tconst pos = webix.html.posRelative(e);\n\t\t\t\tif(pos.x < resizeColumn.size || dx-pos.x < resizeColumn.size+1)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tdragStartColumn = col.cind;\n\t\t}\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousemove\", e => {\n\t\tif(dragStartColumn){\n\t\t\tconst col = grid.locate(e);\n\n\t\t\tif(col){\n\t\t\t\tdragEndColumn = col.cind;\n\t\t\t\tcop.highlightColRow(\n\t\t\t\t\t{column: grid.columnId(dragStartColumn)},\n\t\t\t\t\t{column: grid.columnId(dragEndColumn||1)},\n\t\t\t\t\tview\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst selectColumnHandler = webix.event(document.body, \"mouseup\", () => {\n\t\tif(dragStartColumn){\n\t\t\tif(dragEndColumn != null){\n\t\t\t\tcop.selectColumn(\n\t\t\t\t\tgrid.columnId(dragStartColumn),\n\t\t\t\t\tview,\n\t\t\t\t\tgrid.columnId(dragEndColumn||1)\n\t\t\t\t);\n\t\t\t\tdragEndColumn = null;\n\t\t\t}\n\t\t\tdragStartColumn = null;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\twebix.eventRemove(showCommentHandler);\n\t\twebix.eventRemove(selectColumnHandler);\n\t});\n}\n\nexport function cell_template(view, obj, common, value, column, valueOnly){\n\tconst col = column.id;\n\tconst row = obj.id;\n\tlet css = \"\";\n\n\tconst text = value === \"\" || isNaN(value);\n\tconst format = fmt.getFormatName(view, row, col);\n\tconst invalidDate = fmt.checkFormat(format, \"date\") && fmt.isDateInvalid(value);\n\n\tlet extra = \"\";\n\tif (!valueOnly){\n\t\textra += view.comments.get(row, col) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\t\textra += view.getCellFilter(row, col) ? \"<div class='ssheet_filter_sign'></div>\" : \"\";\n\t}\n\n\t//text can be formatted only in case of string number format\n\tif(!invalidDate && (!text || fmt.checkFormat(format, \"string\"))){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newValue = helper(value, cell);\n\n\t\t\t\tif(newValue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\tcss = `class=\"${cell.css}\"`;\n\t\t\t\t\tvalue = newValue;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue = value * 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = value * 1;\n\t}\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\n\treturn `<div ${css}>${value}</div>${extra}`;\n}\n\nexport function reset(view){\n\tconst grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tconst columns = view.config.columnCount;\n\tconst rows = view.config.rowCount;\n\n\tconst cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate:(el) => {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i<=columns; i++){\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader:{\n\t\t\t\ttext: nms.encode[i]\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\tgrid.refreshColumns(cols);\n\n\tconst data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}\n","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tvar grid = view.$$(\"cells\");\n\n\tvar key = webix.env.isMac ? \"command\" : \"ctrl\";\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\t//ignore shift key\n\t\t\tif ((ev.which || ev.keyCode)  == 16) return;\n\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(view.config.liveEditor)\n\t\t\t\t\tgrid.callEvent(\"onBeforeLiveEditor\", [sel[0]]);\n\t\t\t\telse\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\tview.refresh();\n\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {_to_number, _combine} from \"./helpers\";\n\n/*Empty cells, logical values like TRUE, or text are ignored.*/\nexport function SUM(){\n\tvar sum = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false) sum+=v;\n\t}\n\treturn sum;\n}\n\n/*If a range or cell reference argument contains text, logical values, or empty cells, those values are ignored; \nhowever, cells with the value zero are included.*/\nexport function AVERAGE(){\n\tvar sum = 0, count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false){\n\t\t\tsum+=v; count++;\n\t\t}\n\t}\n\treturn sum/count;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are not counted. */\nexport function COUNT(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false)\n\t\t\tcount++;\n\t}\n\treturn count;\n}\n\n/*counts the number of cells that are not empty in a range, zero is excluded.*/\nexport function COUNTA(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(set[i] && set[i]*1 !==0 ) count++;\n\treturn count;\n}\n\n/*Counts empty cells in a specified range of cells. Cells with zero values are not counted.*/\nexport function COUNTBLANK(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(!set[i]*1) count++;\n\treturn count;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored.\nIf the arguments contain no numbers, MAX returns 0 (zero).*/\nexport function MAX(){\n\tvar max = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v>max || max ===\"\"))\n\t\t\tmax = v;\n\t}\n\treturn max || 0;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored. \nIf the arguments contain no numbers, MIN returns 0.*/\nexport function MIN(){\n\tvar min = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v<min || min ===\"\"))\n\t\t\tmin = v;\n\t}\n\treturn min || 0;\n}\n\n/* Only numbers in the array or reference are multiplied. \nEmpty cells, logical values, and text in the array or reference are ignored.*/\nexport function PRODUCT(){\n\tvar product = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tproduct = product===\"\"?v:product*v;\n\t}\n\treturn product;\n}\n\n/* For valid products only numbers are multiplied. Empty cells, logical values, and text are ignored.\nTreats array entries that are not numeric as if they were zeros.*/\nexport function SUMPRODUCT(sets){\n\tvar length = sets[0].length;\n\tfor(let i in sets)\n\t\tif(sets[i].length !== length)\n\t\t\treturn;\n\n\tvar sp = 0;\n\tfor (let i = 0; i < sets[0].length; i++){\n\t\tvar product = \"\";\n\t\tfor(var s in sets){\n\t\t\tvar v = _to_number(sets[s][i]);\n\t\t\tif(v !== false) product = product===\"\" ? v: product*v;\n\t\t\telse{ product = 0; break; }\n\t\t}\n\t\tif(!webix.isUndefined(product)) sp+=product;\n\t}\n\treturn sp;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function SUMSQ(){\n\tvar sq = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(typeof v ===\"number\")\n\t\t\tsq += Math.pow(v, 2);\n\t}\n\treturn sq;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function VARP(){\n\tvar set = _combine(arguments);\n\tvar count = this.COUNT(set);\n\tvar avg = this.AVERAGE(set);\n\t\n\tvar sum = 0;\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tsum += Math.pow(v - avg, 2);\n\t}\n\treturn sum/count;\n}\n\n/* Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function STDEVP(){\n\tvar set = _combine(arguments);\n\treturn Math.sqrt(this.VARP(set));\n}\n\n/*real numbers*/\nexport function POWER(num, pow){\n\tvar n = _to_number(num), p = _to_number(pow);\n\tif(typeof n == \"number\" && typeof p ==\"number\")\n\t\treturn Math.pow(n, p);\n\t\n}\n\n/*real numbers*/\nexport function QUOTIENT(num, div){\n\tvar n = _to_number(num), d = _to_number(div);\n\tif(typeof n == \"number\" && typeof d ==\"number\")\n\t\treturn n/d;\n}\n\n/*Returns a positive square root.*/\nexport function SQRT(num){\n\tvar v = _to_number(num);\n\tif(v !== false && v>=0)\n\t\treturn Math.sqrt(v);\n}\n\nexport function ABS(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.abs(v);\n}\n\nexport function RAND(){\n\treturn Math.random();\n}\n\nexport function PI(){\n\treturn Math.PI;\n}\n\n/*Rounds a number down to the nearest integer*/\nexport function INT(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.round(v);\n}\n\n/*rounds a number to a specified number of digits*/\nexport function ROUND(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn parseFloat(v.toFixed(d));\n}\n\n/*rounds a number down to a specified number of digits*/\nexport function ROUNDDOWN(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn  Math.floor(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*rounds a number up to a specified number of digits*/\nexport function ROUNDUP(num,digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn Math.ceil(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*Truncates a number to an integer by removing the fractional part of the number.*/\nexport function TRUNC(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn parseInt(v);\n}\n\n/*Returns number rounded up to the nearest even integer*/\nexport function EVEN(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r+1:r;\n\t}\n}\n\n/*Returns number rounded up to the nearest odd integer*/\nexport function ODD(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r:r+1;\n\t}\n}","export function CONCATENATE(){\n\tvar data = Array.prototype.slice.call(arguments);\n\tdata = data.map(function(obj){\n\t\tif (typeof obj === \"object\")\n\t\t\treturn obj.join(\"\");\n\t\treturn obj;\n\t});\n\treturn data.join(\"\");\n}\n \nexport function LEFT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(0, count);\n}\n\nexport function MID(text, start, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(start, start + count);\n}\n\nexport function RIGHT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(text.length - count);\n}\n\nexport function LOWER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toLowerCase();\n}\n\nexport function UPPER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toUpperCase();\n}\n\nexport function PROPER(text) {\n\tif (!text) { return \"\"; }\n\tvar temp = text.toLowerCase().split(\" \");\n\ttext = \"\";\n\tfor (var idx in temp) {\n\t\ttext += (text ? \" \" : \"\") + temp[idx].substring(0, 1).toUpperCase() + temp[idx].substring(1);\n\t}\n\treturn text;\n}\n\nexport function TRIM(text) {\n\tif (!text) { return \"\"; }\n\treturn text.trim();\n}\n\nexport function LEN(text) {\n\tif (!text && text !== 0) { return 0; }\n\treturn text.toString().length;\n}","import {getJsDateFromExcel, getExcelDateFromJs, dayOfTheYear} from \"./helpers\";\n\nexport function DATE(year, month, day){\n\tconst date = new Date(year, month-1, day);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function TIME(hour, minute, second){\n\tconst date = new Date(1900, 0, 1, hour, minute, second);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DAY(date){\n\treturn getJsDateFromExcel(date).getDate();\n}\n\nexport function MONTH(date){\n\treturn getJsDateFromExcel(date).getMonth()+1;\n}\n\nexport function YEAR(date){\n\treturn getJsDateFromExcel(date).getFullYear();\n}\n\nexport function NOW(){\n\tconst date = new Date();\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DATEDIF(start, end, unit){\n\tif(unit != \"D\"){\n\t\tstart = getJsDateFromExcel(start);\n\t\tend = getJsDateFromExcel(end);\n\t}\n\n\tswitch(unit){\n\t\tcase \"Y\":\n\t\t\treturn end.getFullYear() - start.getFullYear();\n\t\tcase \"M\":{\n\t\t\tlet months = (end.getFullYear() - start.getFullYear()) * 12;\n\t\t\treturn months + end.getMonth() - (start.getMonth());\n\t\t}\n\t\tcase \"D\":{ \n\t\t\treturn Math.floor(end - start);\n\t\t}\n\t\tcase \"MD\":{\n\t\t\tconst diff = end.getDate() - start.getDate();\n\t\t\tif(diff < 0){\n\t\t\t\tconst startDateDays = new Date(start.getFullYear(), start.getMonth() + 1, 0).getDate();\n\t\t\t\treturn end.getDate() + startDateDays - start.getDate();\n\t\t\t}\n\t\t\treturn diff;\n\t\t}\n\t\tcase \"YM\":{\n\t\t\tconst months = end.getMonth() - start.getMonth();\n\t\t\treturn months < 0 ? 12 + months : months;\n\t\t}\n\t\tcase \"YD\":{\n\t\t\tconst diff = dayOfTheYear(end) - dayOfTheYear(start);\n\t\t\treturn diff < 0 ? 365 + diff : diff;\n\t\t}\n\t}\n}","export function IMAGE(url){\n\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n}\n\nexport function SPARKLINE(arr, type, color1, color2){\n\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\twidth =  type == \"pie\"? 60: 150;\n\tfor(i =0 ; i < arr.length; i++)\n\t\tarr[i] = arr[i]||0;\n\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n}\n\nexport function HYPERLINK(url, text){\n\ttext = text || url;\n\treturn `<a target=\"blank\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n}\n\nexport function IF(check, pos, neg){\n\tif (check)\n\t\treturn pos;\n\telse\n\t\treturn neg;\t\n}","import * as numbers from \"./methods/numbers\";\nimport * as strings from \"./methods/strings\";\nimport * as date from \"./methods/date\";\nimport * as other from \"./methods/other\";\n\nexport const methods = {};\n\nwebix.extend(methods, numbers);\nwebix.extend(methods, strings);\nwebix.extend(methods, date);\nwebix.extend(methods, other);\n\nexport function addMethod(name, handler){\n\tmethods[name] = handler;\n}","import {getFormatName, checkFormat, isDateInvalid} from \"./formats\";\nimport {getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {getMathFormat} from \"../math/parser\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, type){\n\t\tif(!this._setType){\n\t\t\tconst format = getFormatName(this, row, col);\n\t\t\tsetType(this, row, col, format, type);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeFormatChange\", function(row, col, format){\n\t\tif(!this._setType)\n\t\t\tsetType(this, row, col, format, null, true);\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\"){\n\t\t\tconst format = getFormatName(this, values.row, values.column);\n\t\t\tif(getFormatType(format) != \"date\")\n\t\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t\t}\n\t});\n}\n\nfunction getExpectType(view, row, col, value, parseDate, isFormula, formatType, style){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\n\t\t\tif(/^=(now|date|time)\\(/i.test(value))\n\t\t\t\ttype = \"date\";\n\t\t}\n\t\telse if(!isNaN(value))\n\t\t\ttype = \"number\";\n\t\telse if(formatType != \"string\" && parseDate){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\tvalue  = parser(value);\n\t\t\tif(value != \"\" && !isNaN(value)){\n\t\t\t\t//change cell style - value changes once (some value -> 35767.5)\n\t\t\t\t//change cell value - value changes twice (some value -> \"12/03/97\" -> 35767.5)\n\t\t\t\t//so ignore undo for cell value change\n\t\t\t\tif(style)\n\t\t\t\t\tdateToExcel(view, row, col, value);\n\t\t\t\telse\n\t\t\t\t\tview.ignoreUndo(() => dateToExcel(view, row, col, value));\n\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction dateToExcel(view, row, col, value){\n\tvalue = getExcelDateFromJs(value);\n\tview.setCellValue(row, col, value);\n}\n\nfunction checkType(type, expectType, formatType, isFormula, value){\n\ttype = type || expectType;\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\telse if(formatType)\n\t\ttype = formatType;\n\n\tif(type == \"date\" && !isFormula && isDateInvalid(value))\n\t\ttype = \"number\";\n\n\treturn type;\n}\n\nfunction getFormatType(format){\n\tlet formatType = format ? \"number\" : null;\n\tif(checkFormat(format, \"string\"))\n\t\tformatType = \"string\";\n\telse if(checkFormat(format, \"date\"))\n\t\tformatType = \"date\";\n\treturn formatType;\n}\n\nexport function getType(view, row, column){\n\tconst types = view.getRow(row).$cellType;\n\tif (types && types[column])\n\t\treturn types[column];\n}\n\nfunction setType(view, row, col, format, type, style){\n\t//prevent type change during value or format change\n\tview._setType = true;\n\tlet value = view.getCellValue(row, col);\n\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst parseDate = (!style || format == \"date\") && (!view._loading_data || type == \"date\");\n\n\tconst mathFormat = isFormula && !format ? getMathFormat(view, value) : null;\n\n\tconst formatType = getFormatType(format || mathFormat);\n\tconst expectType = getExpectType(view, row, col, value, parseDate, isFormula, formatType, style);\n\n\ttype = checkType(type, expectType, formatType, isFormula, value);\n\tupdateCell(view, row, col, type, expectType, formatType, mathFormat);\n\n\tconst item = view.getRow(row);\n\tif(!item.$cellType)\n\t\titem.$cellType = {};\n\titem.$cellType[col] = type;\n\n\tdelete view._setType;\n}\n\n\n\nfunction updateCell(view, row, col, type, expectType, formatType, mathFormat){\n\tlet value = view.getCellValue(row, col);\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\tif(mathFormat)\n\t\tview.setFormat(row, col, mathFormat.fmt);\n\telse if(type == \"date\"){\n\t\t// add default date format\n\t\tif(formatType != \"date\"){\n\t\t\tconst isTime = isFormula && value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tconst format = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor)\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t}\n\telse if(formatType != \"string\" && type == \"string\" && expectType != \"string\"){\n\t\t//force text format for numbers typed as strings\n\t\tview.setFormat(row, col, \"@\");\n\t}\n\n\t//remove date editor\n\tif((type != \"date\" || isFormula) && cellEditor && cellEditor.editor == \"excel_date\")\n\t\tview.setCellEditor(row, col, null);\n}\n","import * as methods from \"./math/methods\";\nimport {getJsDateFromExcel} from \"./math/methods/helpers\";\nimport {getDateEditFormat} from \"./operations/formats\";\nimport {getType} from \"./operations/types\";\n\nlet methodsName = [];\nfor(let i in methods.methods)\n\tif( i!=\"__esModule\") methodsName.push(i);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:60\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tvar editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tlet mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(id){\n\t\tif(view.getCellEditor(id.row, id.column))\n\t\t\tthis.edit(id);\n\t\teditor.focus();\n\t});\n\n\tview._table.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onChange\", (mode) => {\n\t\tif (mode == \"update\" && editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif(cell && editor.getValue() != view.getCellValue(cell.row, cell.column)){\n\t\t\t\tdelete editor._update_range;\n\t\t\t\teditor.showActiveSheet();\n\t\t\t\teditor.updateCellValue();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", (name)=> {\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tview._table.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.focus();\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t\tclearEditor();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => view.$handleSelection = null);\n\n\tview.attachEvent(\"onAfterLoad\", () => clearEditor());\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tconst cell = editor.config.activeCell;\n\t\tconst isActiveCell = cell && cell.row == options.row && cell.column == options.column;\n\t\tif(isActiveCell && (name == \"lock\" || name == \"dropdown\"))\n\t\t\tdisableEditor(options.row, options.column);\n\t});\n\n\tview.attachEvent(\"onFormatChange\", (r, c) => updateEditor(r, c));\n\tview.attachEvent(\"onCellChange\", (r, c) => updateEditor(r, c));\n\n\tfunction updateEditor(row, column){\n\t\tconst activeCell = editor.config.activeCell;\n\t\tif(activeCell && activeCell.row == row && activeCell.column == column)\n\t\t\tfillEditor({row, column});\n\t}\n\n\tfunction startEdit(table, cell, clear){\n\t\t//do not interfere with custom editors\n\t\tif (!view.getCellEditor(cell.row, cell.column) && fillEditor(cell, clear)){\n\t\t\teditor.focus();\n\t\t\tif(!clear)\n\t\t\t\teditor.paintValue();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tconst disabled = view.getCellEditor(row, column) || view.isCellLocked(row, column);\n\t\tif(disabled)\n\t\t\teditor.disable();\n\t\telse\n\t\t\teditor.enable();\n\t\treturn disabled;\n\t}\n\n\tfunction fillEditor(cell, clear){\n\t\tconst disabled = disableEditor(cell.row, cell.column);\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : getCellValue(cell.row, cell.column) );\n\n\t\tview.$handleSelection = disabled ? null : function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\treturn !disabled;\n\t}\n\n\tfunction getCellValue(row, column){\n\t\tlet value = view.getCellValue(row, column);\n\t\tif(getType(view, row, column) == \"date\" && value[0] != \"=\"){\n\t\t\tconst format = getDateEditFormat(view.getRow(row), column);\n\t\t\tvalue = format(getJsDateFromExcel(value));\n\t\t}\n\t\treturn value;\n\t}\n\n\tfunction pasteRange(st, en, cell){\n\t\tlet cursor = editor.getInputNode().selectionStart;\n\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t\t}\n\n\t\tconst range = st == en ? sheet+st : `${sheet+st}:${sheet+en}`;\n\t\tconst updateRange = editor._update_range;\n\n\t\tif(updateRange && updateRange.pos == cursor - updateRange.len){\n\t\t\teditor.setRange(range, true);\n\t\t\tcursor = editor._update_range.pos + range.length;\n\t\t}\n\t\telse if(editor.expectOperator()){\n\t\t\teditor.setRange(range);\n\t\t\tcursor += range.length;\n\t\t}\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\teditor.focus();\n\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\teditor.paintValue();\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue();\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction clearEditor(){\n\t\teditor.define({activeCell:null});\n\t\teditor.setValue(\"\");\n\t\teditor.disable();\n\t}\n}\n","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, spans, rows, cols){\n\tfor(let i=0; i<data.length; i++){\n\t\t// data[i] - [ row, column, value, style]\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\n\tif(spans)\n\t\tfor(let i = 0; i < spans.length; i++){\n\t\t\t// spans[i] - [ row, column, colCount, rowCount ]\n\t\t\tconst spanEndRow = spans[i][0] + spans[i][3] - 1;\n\t\t\tconst spanEndCol = spans[i][1] + spans[i][2] - 1;\n\n\t\t\tif(spanEndRow > rows) rows = spanEndRow;\n\t\t\tif(spanEndCol > cols) cols = spanEndCol;\n\t\t}\n\n\treturn [rows*1, cols*1];\n}","import * as arr from \"./helpers/array\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tremove(view, view._activeSheet);\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tlet tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tlet set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj){\n\tgetSheet(view, view._activeSheet).content = obj;\n\treturn view._sheets;\n}\n\nexport function load(view, obj){\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\t\n\tif((obj.excel || !obj.sheets) && view._activeSheet){\n\t\t//loading into active sheet\n\t\tvar name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets)\n\t\tobj = newSheet(obj);\n\t\n\tvar name = obj.sheets[0].name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tvar obj = getSheet(view, name).content;\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tlet [rows, cols] = arr.getDimension(obj.data, obj.spans, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=> {\n\t\t\t\tthis.$hide();\n\t\t\t\twebix.UIManager.setFocus(this.view);\n\t\t\t});\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../math/writer\";\n\nexport const action = \"add-image-cell\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\t\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\n\t\tvar save = this.view.config.save;\n\t\tvar server = (save && save.images) || null;\n\t\t\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\":(image) => this.showPreview(image)\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\t\"onBeforeFileAdd\": startLoad,\n\t\t\t\t\t\t\"onFileUpload\": endLoad\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar cell = this.cell;\n\t\tvar image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tthis.view.addImage(cell.row, cell.column, image);\n\t\tthis.close();\n\t}\n\tfillUrl(url){\n\t\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\t\turl = \"http://\" + url;\n\t\treturn url;\n\t}\n\tshowPreview(image){\n\t\tif (image){\n\t\t\timage = webix.template.escape(this.fillUrl(image));\n\t\t\tthis.$dialog.queryView(\"form\").elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t\t}\n\t}\n}\n\n\nfunction startLoad(file){ \n\tif (!this.config.upload){\n\t\tvar reader = new FileReader();\n\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\treader.readAsDataURL(file.file);\n\t\treturn false;\n\t} else\n\t\tthis.getFormView().elements.preview.setHTML(\"\");\n}\n\nfunction endLoad(item, response){\n\tthis.getFormView().elements.url.setValue(response.imageURL);\n}","import * as box from \"./imagecell\";\n\nexport const action = \"add-image-top\";\n\nexport class DialogBox extends box.DialogBox{\n\topen(action){\n\t\tthis.config = action.config;\n\t\tthis.viewid = action.viewid;\n\t\tbox.DialogBox.prototype.open.apply(this, arguments);\n\t}\n\t$hide(){\n\t\tthis.config = this.viewid = null;\n\t}\n\t$show(box, form){\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\tif(this.config && this.config.data)\n\t\t\tform.elements.url.setValue(this.config.data);\n\t\n\t\tform.elements.url.focus();\n\t}\n\tokClick(){\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tif(this.viewid)\n\t\t\tthis.view.views.update(this.viewid, image);\n\t\telse\n\t\t\tthis.view.views.add(null, null, \"image\", image);\n\t\tthis.close();\n\t}\n}","import * as parser \t\t\tfrom \"./parser\";\n\n//convert math string to the js function\nlet actives = {};\nlet passives = {};\nexport function _parse(value, core, passive){\n\tvar struct = parser.parse(value, core, passive);\n\tif(passive && !passives[passive])\n\t\tpassives[passive] = {};\n\tvar cache = passive ? passives[passive] : actives;\n\tstruct.handler = cache[value] = cache[value] || _build_function(struct.code);\n\treturn struct;\n}\n\nexport function clearMathCache(activeOnly){\n\tactives = {};\n\tif(!activeOnly)\n\t\tpassives = {};\n}\n\nfunction error_function(){\n\treturn webix.i18n.spreadsheet.table[\"math-error\"];\n}\nfunction _build_function(value){\n\ttry{\n\t\treturn new Function(value);\n\t} catch(e){\n\t\treturn error_function;\n\t}\n}","import * as nms from \"../helpers/column_names\";\nimport {split, position} from \"../math/parser\";\n\nexport function updateMath(formula, action, area){\n\tconst stack = split(formula, true);\n\tconst max = stack.length;\n\tconst start = area ? area.start : null;\n\tconst end = area ? area.end : null;\n\tconst {count, id} = action;\n\n\tfor (let i = 1; i < max; i+=2) {\n\t\t//do not update cells in other sheets\n\t\tif(webix.isArray(stack[i])){\n\t\t\tconst [sheet, cell, escaped] = stack[i];\n\t\t\tconst quot = escaped ? \"'\" : \"\";\n\t\t\tstack[i] = quot + sheet + quot + \"!\" + cell;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [row, column, flags] = position(stack[i]);\n\n\t\tconst isRowFix = flags & 1;\n\t\tconst isColumnFix = flags & 2;\n\t\tconst range = checkRange(stack, i);\n\n\t\t// for cut operations we need to check whether referenced values are inside cut block. if so - update them.\n\t\tif (id == \"move\" && (!action.cut || (row >= start.row && row <= end.row && column >= start.column && column <= end.column))){\n\t\t\tcolumn += isColumnFix ? 0 : action.column;\n\t\t\trow += isRowFix ? 0 : action.row;\n\t\t}\n\t\telse if(id == \"row\" || id == \"column\"){\n\t\t\tconst isRow = id == \"row\";\n\t\t\tlet val = isRow ? row : column;\n\t\t\tif(count < 0 && range == \"start\"){\n\t\t\t\tif(action.start <= val && position(stack[i+2])[isRow ? 0 : 1] < action.start + Math.abs(count)){\n\t\t\t\t\tstack[i] = stack[i+2] = \"#REF!\";\n\t\t\t\t\ti += 2;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(action.start <= val){\n\t\t\t\tlet updated;\n\t\t\t\tif(count < 0 && action.start + Math.abs(count) > val){\n\t\t\t\t\tif(range){\n\t\t\t\t\t\tval = action.start - (range == \"end\" ? 1 : 0);\n\t\t\t\t\t\tupdated = true;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tstack[i] = \"#REF!\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!updated)\n\t\t\t\t\tval += count;\n\n\t\t\t\tif(isRow)\n\t\t\t\t\trow = val;\n\t\t\t\telse\n\t\t\t\t\tcolumn = val;\n\t\t\t}\n\t\t}\n\n\t\tif (column <= 0 || row <= 0)\n\t\t\tstack[i] = \"#REF!\";\n\t\telse\n\t\t\tstack[i] = (isColumnFix?\"$\":\"\") + nms.encode[column] + (isRowFix?\"$\":\"\") + row;\n\t}\n\n\treturn stack.join(\"\");\n}\n\nfunction checkRange(stack, index){\n\tif(stack[index+1] == \":\" && stack[index+2])\n\t\treturn \"start\";\n\telse if(stack[index-1] == \":\" && stack[index-2])\n\t\treturn \"end\";\n}\n\nexport function updateSheetNames(formula, oldName, newName, extra){\n\tvar stack = split(formula, true);\n\tfor(var i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tvar thisSheet = stack[i][0] === oldName;\n\t\t\tif(!extra.multiSheet && thisSheet)\n\t\t\t\textra.multiSheet = true;\n\t\t\tvar sheet = thisSheet ? newName : stack[i][0];\n\t\t\tstack[i] = \"'\"+sheet+\"'!\"+stack[i][1];\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}","//TODO\n// ### column deleting | adding\n// recalculate positions\n\n// ### copy paste between sheets\n// force sheet name\n\n// ### triggers\n// a <- p <- a\n// register triggers from passive sheet\n\n// ### sheet renaming\n// adjust math on sheet rename\n// adjust ranges on sheet rename\n\nimport {getActive, getSheet} from \"../sheets\";\nimport {range, encode} from \"../helpers/column_names\";\nimport {clearMathCache} from \"./cache\";\nimport {updateSheetNames} from \"./updater\";\nimport {getDimension} from \"../helpers/array\";\n\nexport function init(view, core, helpers){\n\tview.attachEvent(\"onBeforeSheetShow\", function(){\n\t\tdelete view._mathSheetCache[getActive(view)];\n\t});\n\tview.attachEvent(\"onSheetRename\", function(name, newName){\n\t\tview._sheets.forEach((sheet)=>{\n\t\t\tlet extra = {multiSheet:false};\n\t\t\tconst edit = [\"data\", \"editors\", \"conditions\", \"ranges\"];\n\t\t\tedit.forEach((param)=>{\n\t\t\t\tif(sheet.content[param])\n\t\t\t\t\tsheet.content[param].forEach((value)=>{\n\t\t\t\t\t\tswitch (param) {\n\t\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\t\tif(value[2][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[2] = updateSheetNames(value[2], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"editors\": {\n\t\t\t\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\t\t\t\tif(options){\n\t\t\t\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(options, name, newName, extra);\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\t\t\t\tconst option = typeof options[i] == \"string\" ? options[i] : options[i].value;\n\t\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(option, name, newName, extra);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase \"conditions\":\n\t\t\t\t\t\t\t\tif(value[3][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[3] = updateSheetNames(value[3], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ranges\":\n\t\t\t\t\t\t\t\tvalue[1] = updateSheetNames(value[1], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tif(extra.multiSheet === true){\n\t\t\t\tdelete view._mathSheetCache[sheet.name];\n\t\t\t\tgetAccessor(view, sheet.name);\n\t\t\t\tclearMathCache();\n\t\t\t}\n\t\t});\n\t\tdelete view._mathSheetCache[name];\n\t});\n\tview.attachEvent(\"onSheetRemove\", function(name){\n\t\tdelete view._mathSheetCache[name];\n\t});\n\n\tview._mathSheetCore = core;\n\tview._mathSheetHelpers = helpers;\n}\n\nexport function getAccessor(view, name){\n\tconst cache = view._mathSheetCache;\n\n\tif (!cache[name]){\n\t\tconst helpers = (!name || name == getActive(view)) ? activeAccessor(view) : passiveAccessor(view, name);\n\n\t\t//invalid sheet name\n\t\tif(!helpers)\n\t\t\treturn;\n\n\t\tconst temp = cache[name] = SheetAccessor(helpers);\n\n\t\ttemp.init();\n\t}\n\treturn cache[name];\n}\n\nfunction SheetAccessor(helpers){\n\treturn {\n\t\tinit:function(){\n\t\t\thelpers.init();\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn helpers.getRangeCode(name);\n\t\t},\n\t\tgetItem:function(r){\n\t\t\treturn helpers.getRow(r);\n\t\t},\n\t\tgetValue(r,c){\n\t\t\tvar val = helpers.getCell(r,c);\n\t\t\tvar test = val*1;\n\t\t\tif (!isNaN(test) && val !== \"\") return test;\n\t\t\treturn val?val:\"\";\n\t\t},\n\t\tgetRangeValue(name){\n\t\t\tvar code = this.getRangeCode(name) || name;\n\t\t\tif (code.indexOf(\":\") == -1) return [];\n\t\t\tvar pos = range(code);\n\t\t\treturn this.getRange.apply(this, pos);\n\t\t},\n\t\tgetRange(r1,c1,r2,c2){\n\t\t\tconst set = helpers.getRange(r1,c1,r2,c2);\n\t\t\tfor (let i = set.length-1; i>=0; i--){\n\t\t\t\tlet val = set[i];\n\t\t\t\tlet test = val !== \"\" ? val * 1 : \"\";\n\t\t\t\tset[i] = isNaN(test) ? (val?val:\"\") : test;\n\t\t\t}\n\t\t\treturn set;\n\t\t},\n\t\tgetName: function(){\n\t\t\treturn helpers.getName();\n\t\t},\n\t\tgetRangeCols:function(){\n\t\t\treturn getRangeCols.apply(helpers, arguments);\n\t\t},\n\t\tgetRangeRows:function(){\n\t\t\treturn getRangeRows.apply(helpers, arguments);\n\t\t}\n\t};\n}\n\nfunction activeAccessor(view){\n\treturn {\n\t\tinit:function(){\n\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn view.ranges.getCode(name);\n\t\t},\n\t\tgetRow:function(r){\n\t\t\treturn view.getRow(r);\n\t\t},\n\t\tgetCell:function(r,c){\n\t\t\tif(c > view.config.columnCount)\n\t\t\t\tthrow \"Сolumn does not exist\";\n\t\t\treturn view.getRow(r)[c];\n\t\t},\n\t\tgetName: function(){\n\t\t\treturn \"\";\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(item[j]);\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction passiveAccessor(view, name){\n\tconst sheet = getSheet(view, name);\n\tif(!sheet)\n\t\treturn;\n\n\tconst page = sheet.content;\n\tconst table = [];\n\tconst formulas = [];\n\n\tconst ranges = [];\n\n\treturn {\n\t\tinit:function(){\n\t\t\tif (page.ranges){\n\t\t\t\tfor (var i = 0; i < page.ranges.length; i++) {\n\t\t\t\t\tvar line = page.ranges[i];\n\t\t\t\t\tranges[line[0]] = line[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (page.data){\n\t\t\t\tfor (let i = 0; i < page.data.length; i++) {\n\t\t\t\t\t//expand data structure\n\t\t\t\t\tlet [row, column, value] = page.data[i];\n\t\t\t\t\tif (!table[row])\n\t\t\t\t\t\ttable[row] = [];\n\t\t\t\t\ttable[row][column] = value;\n\n\t\t\t\t\tif (value[0] === \"=\"){\n\t\t\t\t\t\t//for math cells, store the code\n\t\t\t\t\t\tlet math = view._mathSheetHelpers.parse(value, view._mathSheetCore, name);\n\t\t\t\t\t\ttable[row][column] = math.handler;\n\n\t\t\t\t\t\t//store list of cross-sheet formulas\n\t\t\t\t\t\tfor (var j=0; j<math.triggers.length; j++){\n\t\t\t\t\t\t\tif (math.triggers[j][5]){\n\t\t\t\t\t\t\t\tformulas.push(page.data[i]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn ranges[name];\n\t\t},\n\t\tgetRow(i){\n\t\t\treturn table[i] || [];\n\t\t},\n\t\tgetCell(i, j){\n\t\t\tconst [,cols] = getDimension(page.data, page.spans, 0, view.config.columnCount);\n\n\t\t\tif(j > cols)\n\t\t\t\tthrow \"Сolumn does not exist\";\n\n\t\t\tconst value = this.getRow(i)[j];\n\t\t\tif (typeof value === \"function\")\n\t\t\t\treturn view._mathSheetHelpers.execute(value, view._mathSheetCore);\n\n\t\t\treturn value;\n\t\t},\n\t\tgetName:function(){\n\t\t\treturn name;\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++)\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(this.getCell(i,j));\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction getRangeCols(r1,c1,r2,c2,lastIndex){\n\tlastIndex = lastIndex || 0;\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = r1, rind = 0; i <= r2; i++, rind++){\n\t\tdata[rind] = {};\n\t\tconst item = this.getRow(i);\n\t\tfor (let j = c1, cind = lastIndex; j <= c2; j++, cind++){\n\t\t\tif(i == r2){\n\t\t\t\tconst sheetName = this.getName();\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[j]}${r1}:${encode[j]}${r2}`] = `data${cind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[rind][`data${cind}`] = item[j];\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}\n\nfunction getRangeRows(r1,c1,r2,c2,lastIndex){\n\tlastIndex = lastIndex || 0;\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = c1, cind = 0; i <= c2; i++, cind++){\n\t\tdata[cind] = {};\n\t\tfor (let j = r1, rind = lastIndex; j <= r2; j++, rind++){\n\t\t\tconst item = this.getRow(j);\n\t\t\tif(i == c2){\n\t\t\t\tconst sheetName = this.getName();\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[c1]}${j}:${encode[c2]}${j}`] = `data${rind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[cind][`data${rind}`] = item[i];\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}","import {range} from \"../helpers/column_names\";\nimport {getAccessor} from \"./sheet\";\nimport {cell_template} from \"../table\";\nimport {clearMathCache} from \"./cache\";\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nfunction getRange(view, r1,c1,r2,c2,sheet){\n\tconst values = [];\n\tfor (let i=r1; i<=r2; i++){\n\t\tconst item = this.getItem(i);\n\t\tfor (let j=c1; j<=c2; j++){\n\t\t\tlet value = (item[j] || item[j] === 0) ? item[j] : \"\";\n\t\t\tvalue = { id:value, value:value };\n\n\t\t\tif (!sheet || sheet == view._activeSheet){\n\t\t\t\tvalue[\"$value\"] = cell_template(view, item, null, item[j], {id:j}, true);\n\t\t\t\tvalue[\"format\"] = item.$cellFormat && item.$cellFormat[j];\n\t\t\t}\n\t\t\tvalues.push(value);\n\t\t}\n\t}\n\treturn values;\n}\n\nexport function rangeOptions(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif (pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? getRange.apply(page, [view, ...pos]) : [];\n\t\t}\n\t}\n\telse if (webix.isArray(text))\n\t\tfor (let i=0; i<text.length; i++){\n\t\t\tlet v = (text[i] || text[i] === 0) ? text[i] : \"\";\n\t\t\tv = (typeof v === \"object\") ? webix.copy(v) : { id:v, value:v };\n\t\t\tvalues.push(v);\n\t\t}\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tconst test = {};\n\t\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\t\tif (test[values[i].id])\n\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\ttest[values[i].id] = true;\n\t\t\t}\n\t\t}\n\n\t\tlet empty = false;\n\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\tvalues[i].value = String(values[i].value);\n\t\t\tif (values[i].value === \"\"){\n\t\t\t\tvalues.splice(i, 1);\n\t\t\t\tempty = true;\n\t\t\t}\n\t\t}\n\n\t\tif (extra.order)\n\t\t\tvalues.sort(function(objA, objB){\n\t\t\t\tconst sorters = view.$$(\"cells\").data.sorting.as;\n\t\t\t\tconst a = objA.value;\n\t\t\t\tconst b = objB.value;\n\n\t\t\t\treturn webix.rules.isNumber(a) && webix.rules.isNumber(b) ? sorters.int(a, b) : sorters.string(a, b);\n\t\t\t});\n\n\t\tif (empty && extra.filter)\n\t\t\tvalues.unshift( nullFilter() );\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}\n\nexport function rangeValues(view, text){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif (pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? page.getRange.apply(page, pos) : [];\n\t\t}\n\t} else\n\t\tvalues = webix.copy(text);\n\n\treturn values;\n}\n\nexport class Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t\tthis._ranges = {};\n\t}\n\tclear(){\n\t\tthis._ranges = {};\n\t}\n\tadd(name, text){\n\t\tthis._master.callEvent(\"onAfterRangeSet\", [name, text]);\n\t\tthis._ranges[name] = text;\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, sheet){\n\t\tif (sheet){\n\t\t\tconst accessor = getAccessor(this._master, sheet);\n\t\t\treturn accessor ? accessor.getRangeCode(name) : null;\n\t\t}\n\n\t\treturn this._ranges[name];\n\t}\n\tremove(name){\n\t\tdelete this._ranges[name];\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetRanges(){\n\t\tvar data = [];\n\t\tfor(var name in this._ranges)\n\t\t\tdata.push({ name, range:this._ranges[name] });\n\n\t\treturn data;\n\t}\n\tparse(data){\n\t\tif (!data) return;\n\n\t\tlet i = data.length;\n\t\twhile(i--){\n\t\t\tvar c = data[i];\n\t\t\tthis._ranges[c[0]] = c[1];\n\t\t}\n\t}\n\tserialize(){\n\t\tvar name, data = [];\n\t\tfor( name in this._ranges)\n\t\t\tdata.push([name,this._ranges[name]]);\n\t\treturn data;\n\t}\n}\n","import {Dialog} from \"./common\";\nimport {rangeValues} from \"../math/ranges\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../math/writer\";\n\nexport const action = \"add-sparkline\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nfunction getTypes(){\n\treturn  [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]}\n\t];\n}\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tvar els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\trenderPreview(this);\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", visibleBatch:1, on:{ onChange : ()=> renderPreview(this) },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:getTypes()\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\t\"onChange\": typesChangeHandler\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:labels[\"error-range\"]});\n\t}\n}\n\nfunction renderPreview(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar data = form.getValues();\n\n\tif (data.range && dialog.checkRange(data.range)){\n\t\tlet i,\n\t\t\tvalues = rangeValues(dialog.view, data.range),\n\t\t\tconfig = sparkConfig(form);\n\t\tfor(i =0 ; i < values.length; i++)\n\t\t\tvalues[i] = values[i]||0;\n\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t}\n}\n\nfunction sparkConfig(form, config){\n\tvar data = form.getValues();\n\tconfig = config || { type: data.type  };\n\tif (data.type === \"bar\"){\n\t\tconfig.color = data.color_pos;\n\t\tconfig.negativeColor = data.color_neg;\n\t}\n\telse if(form.elements.color_def.isVisible())\n\t\tconfig.color = data.color_def;\n\n\treturn config;\n}\n\nfunction okClick(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar config = sparkConfig(form, form.getValues());\n\tif (dialog.checkRange(config.range)){\n\t\tdialog.view.addSparkline(dialog.cell.row, dialog.cell.column, config);\n\t\tdialog.close();\n\t}\n}\n\n\n\n\nfunction typesChangeHandler(type){\n\tvar form = this.getFormView();\n\tswitch(type){\n\t\tcase \"pie\":\n\t\t\tform.showBatch(3);\n\t\t\tbreak;\n\t\tcase \"bar\":\n\t\t\tform.showBatch(2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tform.showBatch(1);\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tvar table = box.$$(\"table\");\n\t\tvar form = box.$$(\"form\");\n\t\tvar sheet = \"\";// this.view.getActiveSheet(); ranges are per-sheet by default\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\t\tform.elements.name.focus();\n\t\tform.elements.range.setValue(this.view.getSelectedRange());\n\n\t\ttable.clearAll();\n\t\ttable.parse( this.view.ranges.getRanges() );\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,sheet));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tsaveClick(){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tconst sheets = data.range.indexOf(\"!\");\n\t\tdata.range = data.range.substr(0, sheets+1)+data.range.substr(sheets+1).toUpperCase();\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\n\t\t\tif (data.id && table.exists(data.id))\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tthis.view.ranges.add(data.name, data.range);\n\t\t\tform.clear();\n\t\t}\n\t}\n\tremoveRange(id){\n\t\tthis.view.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\tthis.view.ranges.remove(table.getItem(id).name);\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tform.clearValidation();\n\t\tform.setValues(this.$dialog.$$(\"table\").getItem(id));\n\t}\n\t$init(){\n\t\tvar theform = {\n\t\t\tpadding:0,\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:webix.i18n.spreadsheet.labels[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:webix.i18n.spreadsheet.labels[\"range-cells\"], width: 120 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-pencil'></div>\", width:44 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-trash'></div>\", width:44 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 150,\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 250, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname:(value) => { \n\t\t\t\t\t\t\tlet correct = /^[A-Za-z]+$/.test(value);\n\t\t\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\t\t\tlet data = this.$dialog.$$(\"form\").getValues();\n\n\t\t\t\t\t\t\tlet unique = true;\n\t\t\t\t\t\t\ttable.eachRow(function(id){\n\t\t\t\t\t\t\t\tlet obj = this.getItem(id);\n\t\t\t\t\t\t\t\tif (obj.name == value && obj.id != data.id)\n\t\t\t\t\t\t\t\t\tunique = false; \n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn correct && unique; \n\t\t\t\t\t\t},\n\t\t\t\t\t\trange:isRange\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 70\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-cells\"]},\n\t\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t{ view:\"button\", value:\"Save\", click: () => this.saveClick() }\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tbuttons: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 610,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0, view:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (var i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"ss_richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {lockCss} from \"./lock_cell\";\nimport {find, findIndex} from \"../helpers/array\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span){\n\t\t\tvar extraCss = getExtraCss(view, row, column);\n\t\t\tspan[3] = (style ? style.id : \"\") + (extraCss ? (\" \" + extraCss) : \"\");\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.spans)\n\t\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\t\tvar span = data.spans[i];\n\t\t\t\taddSpan( view,\n\t\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\t\tspan[2]*1,\n\t\t\t\t\tspan[3]*1,\n\t\t\t\t\ttrue \n\t\t\t\t);\n\t\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar spans = [];\n\t\tvar pull = view.$$(\"cells\").getSpan();\n\t\tif (pull){\n\t\t\tfor (var rid in pull){\n\t\t\t\tvar row = pull[rid];\n\t\t\t\tfor (var cid in row){\n\t\t\t\t\tvar span = row[cid];\n\t\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.spans = spans;\n\t\t}\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetSpanCss(view, options.row, options.column, lockCss, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(options.name,options.inc,options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tvar row = view.getRow(cell.row);\n\t\tvar css = row.$cellCss ? (row.$cellCss[cell.column] || \"\") : \"\";\n\t\tvar extraCss = getExtraCss(view, cell.row, cell.column);\n\t\tif (extraCss)\n\t\t\tcss += \" \" + extraCss;\n\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif (!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nexport function setSpanCss(view, row, column, css, add){\n\tconst span = getSpan(view, row, column);\n\tif (span){\n\t\tif (add){\n\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\tspan[3] += \" \" + css;\n\t\t} else {\n\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t}\n\t}\n}\n\nfunction getExtraCss(view, row, column){\n\treturn view.getCellEditor(row, column) ? \"ss_editor\"\n\t\t: (view.getCellFilter(row, column) ? \"ss_filter\" : \"\");\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, data){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tvar value = find(data, function(value) {\n\t\t\t\treturn (value[0] == span[0] && value[1] == span[1]);\n\t\t\t});\n\n\t\t\tvalue[0] = action.group == \"row\" ? value[0] - inc : value[0];\n\t\t\tvalue[1] = action.group == \"column\" ? value[1] - inc : value[1];\n\n\t\t\tvar oldValue = findIndex(data, function(oldValue) {\n\t\t\t\treturn oldValue[0] == value[0] && oldValue[1] == value[1] && (oldValue[2] != value[2] || oldValue[3] != value[3]); \n\t\t\t});\n\n\t\t\tif(oldValue > -1) //remove another data at the same place\n\t\t\t\tdata.splice(oldValue,1);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import group from \"./undo_group\";\nimport {getType} from \"./types\";\nimport {setSpanCss} from \"./spans\";\nimport {isDateInvalid} from \"./formats\";\nimport {rangeOptions} from \"../math/ranges\";\nimport {changeRange, eachRange, toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.on_click.ssheet_filter_sign = (e, id) => {\n\t\tconst filter = table._ssFilters[id.row][id.column];\n\t\tconst mode = filter.mode || getFilterMode(view, id.row, id.column);\n\n\t\tlet options = [];\n\t\tif (filter.options){\n\t\t\tif (typeof filter.options == \"string\")\n\t\t\t\toptions = rangeOptions(view, filter.options, { unique:true, order:true, filter:true });\n\t\t\telse if (webix.isArray(filter.options))\n\t\t\t\toptions = rangeOptions(view, filter.options, { filter:true });\n\t\t}\n\t\tview.callEvent(\"onCommand\", [{id:\"start-filter\", cell:id, mode, options, filter}]);\n\t};\n\ttable.on_dblclick.ssheet_filter_sign = () => false;\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\ttoggleFilters(view);\n\t});\n\n\tlet refilter = false;\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"filter\"){\n\t\t\tvalue = (typeof value == \"object\") ? value : null;\n\t\t\tview.setCellFilter(row, column, value);\n\t\t\trefilter = true;\n\t\t}\n\t\telse if (type == \"apply-filter\"){\n\t\t\tconst filter = view.getCellFilter(row, column);\n\n\t\t\tfilter.value = value;\n\t\t\tdelete filter.handler;\n\t\t\tif (value && value.condition){\n\t\t\t\tconst mode = filter.mode || getFilterMode(view, row, column);\n\t\t\t\tfilter.handler = getFilterFunction(mode, filter.value);\n\t\t\t}\n\t\t\trefilter = true;\n\n\t\t\t// update css\n\t\t\tconst add = value && isValueActive(value);\n\t\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, \"ss_filter_active\");\n\t\t\tsetSpanCss(view, row, column, \"ss_filter_active\", add);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterUndo\", () => {\n\t\tif (refilter){\n\t\t\tview.filterSpreadSheet();\n\t\t\trefilter = false;\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"filter\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter\", p.newValue);\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter_active\", (p.newValue && p.newValue.value && isValueActive(p.newValue.value)));\n\t\t\tmarkBarFilter(view);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssFilters = {};\n\tmarkBarFilter(view);\n}\n\nexport function getFilters(table){\n\tconst filters = table._ssFilters;\n\tconst all = [];\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tconst filters = getFilters(view._table);\n\tconst result = data.filters = [];\n\n\tfor (let i = 0; i<filters.length; i++){\n\t\tlet {row, column, options, mode, value} = filters[i];\n\t\tvalue = value && webix.copy(value);\n\t\tresult.push([row, column, {value, options, mode}]);\n\t}\n}\n\nexport function load(view,data){\n\tconst filters = data.filters;\n\n\tif (filters){\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tview.setCellFilter(filters[i][0], filters[i][1], (filters[i][2] || {options:\"\"}));\n\t\t}\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nexport function clearFilters(view, range){\n\tlet refilter = false;\n\teachRange(range, view, function(view, cell){\n\t\tlet filter = view._table._ssFilters[cell.row];\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\trefilter = true;\n\t\t\t\tdelete filter[cell.column];\n\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter\", false);\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter_active\", false);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tconst filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function calibrateRange(view, row, column, range){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\treturn range;\n}\n\nexport function isValueActive(value){\n\treturn !!(value.includes || (value.condition && value.condition.filter));\n}\n\nfunction isFilterExists(view){\n\tconst filters = view._table._ssFilters;\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tif (filters[row][column]) return true;\n\treturn false;\n}\n\nfunction markBarFilter(view){\n\tconst value = isFilterExists(view);\n\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"create-filter\", value}]);\n}\n\n\nfunction getFilterRange(view, row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1, column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}\n\nexport function getFilterMode(view, row, column){\n\tfor (let i=row; i<view.config.rowCount; i++){\n\t\tconst item = view.getRow(i+1);\n\t\tconst value = item[\"$\"+column] || item[column];\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i+1, column);\n\t\t\treturn (type == \"number\" || type == \"date\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}\n\nfunction toggleFilters(view){\n\tconst range = view._table.getSelectArea();\n\n\tif (isFilterExists(view)){\n\t\tgroup.set(function(){\n\t\t\tview.removeFilters();\n\t\t});\n\t\tif (range)\n\t\t\tview._table.addSelectArea(range.start, range.end);\n\t}\n\telse if (range)\n\t\tgroup.set(function(){\n\t\t\tlet row = range.start.row;\n\t\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\t\tview.setCellFilter(row, i, { options:range });\n\t\t\t}\n\t\t});\n\tmarkBarFilter(view);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tconst filters = data.filters;\n\n\tif (inc){\n\t\tfor(let i=filters.length-1; i>=0; i--){\n\t\t\tlet [row,column,filter] = filters[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete filter mark if row was deleted\n\t\t\t\t\t\tfilters.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tfilters[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tfilters.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\tfilters[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\tfilter.options = changeRange(filter.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteFilter(view, extra, row, col, cutted, translate){\n\tconst filter = extra.filter;\n\n\tfilter.options = changeRange(filter.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\tfilter.options = changeRange(filter.options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\n\tdelete filter.value; delete filter.handler;\n\tview.setCellFilter(row, col, filter);\n}\n\nexport function getSingleOption(mode, type){\n\tconst c = conditions[mode];\n\tfor (let i=0; i<c.length; i++)\n\t\tif (c[i].id == type) return c[i];\n}\n\nexport function getConditions(name){\n\treturn webix.copy( conditions[name] );\n}\n\nexport function getFilterFunction(mode, value){\n\tconst { includes, condition } = value;\n\tconst opt = getSingleOption(mode, condition.type);\n\tconst handler = opt ? opt.handler : function(){ return true; };\n\n\tif (includes){\n\t\tfor (let i=0; i<includes.length; i++)\n\t\t\tincludes[i] = String(includes[i]);\n\t}\n\n\treturn function(value){\n\t\tif (includes){\n\t\t\treturn includes.indexOf(value) !== -1;\n\t\t} else {\n\t\t\treturn condition.filter === \"\" || handler(value, condition.filter);\n\t\t}\n\t};\n}\n\nfunction isDate(value){\n\treturn value && !isNaN(value) && !isDateInvalid(value);\n}\n\nconst conditions = {\n\tnumber:[\n\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t}},\n\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){ return a == b; }},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){ return a != b; }},\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) === -1;\n\t\t}}\n\t],\n\ttext: [\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) === -1;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase() === b.toLowerCase();\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase() !== b.toLowerCase();\n\t\t}},\n\t\t{ id:\"beginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().lastIndexOf(b.toLowerCase(), 0) === 0;\n\t\t}},\n\t\t{ id:\"notBeginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().lastIndexOf(b.toLowerCase(), 0) !== 0;\n\t\t}},\n\t\t{ id:\"endsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) !== -1;\n\t\t}},\n\t\t{ id:\"notEndsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) === -1;\n\t\t}}\n\t],\n\tdate: [\n\t\t{ id:\"greater\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a > b;\n\t\t}},\n\t\t{ id:\"less\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a < b;\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a >= b;\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a <= b;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a == b;\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn !isDate(a) || a != b;\n\t\t}},\n\t\t{ id:\"between\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]\n};","import {Dialog} from \"./common\";\nimport * as flt from \"../operations/filter\";\n\nexport const action = \"start-filter\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.cell = action.cell;\n\t\tthis.$mode = action.mode;\n\t\tthis.$filter = action.filter;\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column))){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", () => this.$hide());\n\n\t\t\tconst table = this.view.$$(\"cells\");\n\t\t\ttable.attachEvent(\"onScrollY\", () => this.syncScroll());\n\t\t\ttable.attachEvent(\"onScrollX\", () => this.syncScroll());\n\t\t}\n\n\t\tif (this.$show(this.$filter.value, action.options) === false)\n\t\t\treturn this.close();\n\t\tthis.$dialog.show( this._getTargetNode() );\n\t}\n\t_getTargetNode(){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = table.getSpan(this.cell.row, this.cell.column);\n\t\treturn span ? table.getSpanNode(this.cell) : table.getItemNode(this.cell);\n\t}\n\t$show(value, options){\n\t\tconst list = this.getList();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.$mode){\n\t\t\tfilter.define(\"conditions\", this.getConditions(this.$mode));\n\t\t\tfilter.define(\"mode\", this.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tconst type = value && value.conditions && value.conditions.type;\n\t\tif (type && !flt.getSingleOption(this.$mode, type))\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(options);\n\n\t\t// filter data has been changed - reset value\n\t\tfilter.config.value = \"\";\n\t\tfilter.setValue( webix.copy(value||{}) );\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview:\"popup\",\n\t\t\tcss:\"ssheet_filter\",\n\t\t\tpadding:7,\n\t\t\trelative:\"right\",\n\t\t\tbody:{\n\t\t\t\tmargin:4,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"filter\",\n\t\t\t\t\t\tfield:\"value\",\n\t\t\t\t\t\tmode:\"text\",\n\t\t\t\t\t\tconditions:this.getConditions(\"text\"),\n\t\t\t\t\t\tinputs:[\n\t\t\t\t\t\t\t\"text\",\n\t\t\t\t\t\t\t{ view:\"ssheet-datepicker\", timepicker:true, batch:\"datepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t{ view:\"ssheet-daterangepicker\", timepicker:true, batch:\"daterangepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttemplate:function(obj){\n\t\t\t\t\t\t\treturn obj.$value || obj.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"cancel\"], autowidth:true, css:\"webix_transparent\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.close()\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"apply\"], autowidth:true, css:\"webix_secondary\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.applyFilter()\n\t\t\t\t\t\t}},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapplyFilter(){\n\t\tconst filter = this.getFilter();\n\t\tconst oldValue = this.$filter.value;\n\t\tconst value = this.$filter.value = filter.getValue();\n\t\tthis.$filter.handler = flt.getFilterFunction(this.$mode, value);\n\n\t\tthis.view.filterSpreadSheet();\n\t\tthis.view.callEvent(\"onAction\", [\"apply-filter\", { row:this.cell.row, column:this.cell.column, value:oldValue, newValue:value }]);\n\t\tthis.setCellStyle(this.cell.row, this.cell.column, \"ss_filter_active\", flt.isValueActive(value));\n\n\t\tthis.close();\n\t}\n\tsetCellStyle(row, column, css, add){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = this.getSpan(table, row, column);\n\n\t\tif (span){\n\t\t\tif (add){\n\t\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\t\tspan[3] += \" \" + css;\n\t\t\t} else {\n\t\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t\t}\n\t\t}\n\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, css);\n\t}\n\tgetSpan(table, row, column){\n\t\tlet item = table.getSpan()[row];\n\t\tif (item)\n\t\t\treturn item[column];\n\t}\n\tgetList(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t}\n\tgetFilter(){\n\t\treturn this.$dialog.getBody().getChildViews()[0];\n\t}\n\tsyncScroll(){\n\t\tif (this.$dialog.isVisible()){\n\t\t\tconst node = this._getTargetNode();\n\t\t\tconst table = this.view.$$(\"cells\");\n\n\t\t\tlet isHidden = false;\n\t\t\tif (node){\n\t\t\t\tconst nodeOffset = webix.html.offset( node );\n\t\t\t\tconst tableOffset = webix.html.offset( table.$view.getElementsByClassName(\"webix_ss_body\")[0] );\n\t\t\t\tconst ydiff = nodeOffset.y - tableOffset.y;\n\t\t\t\tconst xdiff = nodeOffset.x - tableOffset.x + nodeOffset.width;\n\n\t\t\t\tisHidden = (ydiff < 0 || ydiff+nodeOffset.height > tableOffset.height || \n\t\t\t\t\txdiff < 0 || xdiff-nodeOffset.width > tableOffset.width - webix.env.scrollSize);\n\t\t\t}\n\t\t\tif (!node || isHidden)\n\t\t\t\tthis.$dialog.show({x:-9999, y:-9999});\n\t\t\telse \n\t\t\t\tthis.$dialog.show(node);\n\t\t}\n\t}\n\tgetConditions(name){\n\t\tconst locale = webix.i18n.filter;\n\t\tconst conditions = flt.getConditions(name);\n\n\t\tfor (let i=0; i<conditions.length; i++)\n\t\t\tif (conditions[i].id)\n\t\t\t\tconditions[i].value = locale[conditions[i].id];\n\n\t\treturn conditions;\n\t}\n}","import {Dialog} from \"./common\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\theight: 160,\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}, {id:4}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.show();\n\t\t\t\t\t\t\t\t\t\tif(id[0] == \"percent\")\n\t\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\theight:280,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 140\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst style = this.view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tconst name = style && style.props.format ? style.props.format : \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:name}]);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst style = view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = style && style.props.format ? style.props.format : \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tconst item = this.view.$$(\"cells\").getItem(this.cell[0].row);\n\t\tconst col = this.cell[0].column;\n\n\t\tthis.value = webix.isUndefined(item[col]) ? \"\" : item[col];\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\t\tconst format = this.getFormat();\n\t\tlet value = this.value;\n\n\t\tconst isText = value === \"\" || isNaN(value);\n\n\t\tif(fmt.checkFormat(format, \"date\") && (isText || fmt.isDateInvalid(value)))\n\t\t\tvalue = 45000;\n\t\telse if(isText && !fmt.checkFormat(format, \"string\"))\n\t\t\tvalue = 1234.56789;\n\n\t\tlet style = {css:\"\"};\n\t\tvalue = fmt.format2code(format.fmt, format.delimiters)(value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nimport {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {isDateInvalid} from \"../operations/formats\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nexport const action = \"conditional-format\";\n\nconst condition = [\n\t{id: \">\",value: \">\" },\n\t{id: \"<\",value: \"<\"},\n\t{id: \"=\",value: \"=\"},\n\t{id: \"!=\",value: webix.i18n.spreadsheet.labels[\"conditional-not-equal\"]},\n\t{id: \"<>\",value: webix.i18n.spreadsheet.labels[\"conditional-between\"]}\n];\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition !== \"<>\"){\n\t\t\t\titem.push(this._normalizeValue(values.value));\n\t\t\t} else {\n\t\t\t\titem.push([this._normalizeValue(values.value), this._normalizeValue(values.value2)]);\n\t\t\t}\n\t\t\titem.push(values.style);\n\t\t\tfor(var i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\")\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tvar num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tvar view = this.view;\n\t\tvar collection = view.conditions.get(this.cell.row, this.cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tvar values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = this._formatValue(item[1][0]);\n\t\t\t\t\tvalues.value2 = this._formatValue(item[1][1]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = this._formatValue(item[1]);\n\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\t_formatValue(value){\n\t\tif(this.editFormat && value !== \"\" && value[0] != \"=\"){\n\t\t\tvalue = getJsDateFromExcel(value);\n\t\t\treturn this.editFormat(value);\n\t\t}\n\t\treturn value.toString();\n\t}\n\n\t_normalizeValue(value){\n\t\tif(this.editFormat){\n\t\t\tif(isNaN(value)){\n\t\t\t\tif(value[0] != \"=\"){\n\t\t\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\t\t\tvalue = parser(value);\n\t\t\t\t\tvalue = isNaN(value) ? \"\" : getExcelDateFromJs(value);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = isDateInvalid(value) ? \"\" : value;\n\t\t}\n\t\telse\n\t\t\tvalue = this._safeInt(value, 10);\n\n\t\treturn value;\n\t}\n\n\tapply(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t$show(){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst item = this.view.getRow(this.cell.row);\n\t\tlet type = item.$cellType;\n\t\tif(type)\n\t\t\ttype = type[this.cell.column];\n\n\t\tif(type == \"date\")\n\t\t\tthis.editFormat = getDateEditFormat(item, this.cell.column);\n\n\t\tthis.$dialog.queryView(\"text\", \"all\").forEach(view => {\n\t\t\tview.define({placeholder: type == \"date\" ? this._formatValue(45000) : \"\"});\n\t\t\tview.refresh();\n\t\t});\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tdelete this.editFormat;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tpadding:{\n\t\t\t\tleft: 12\n\t\t\t},\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", width:131, label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", width: 116, label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\t\t\tcss:\"webix_ssheet_cformats\",\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tvar css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 105,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv){\n\t\t\t\t\t\t\t\tif(newv === \"<>\"){\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.show();\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: condition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click:clearRow }\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\tconst margin = webix.skin.$active.layoutMargin.form;\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 670,\n\t\t\tmove: true,\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tpadding:0,\n\t\t\t\tborderless: true,\n\t\t\t\tmargin,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmargin,\n\t\t\t\t\t\trows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{gravity:2},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.apply,\n\t\t\t\t\t\t\t\tclick: () => this.apply()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction clearRow(){\n\t//this - clear icon\n\tvar form = this.getFormView();\n\tform.clear();\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++)\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\n\t\treturn value;\n\t}\n}\n\nfunction okClick(dialog){\n\tconst values = dialog.$dialog.getBody().getValues();\n\twebix.toExcel(dialog.view, values);\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tvar item = this.view.getRow(cell.row);\n\t\t\tvar value = item[\"$\"+cell.column] || item[cell.column];\n\t\t\tif (value && value.indexOf(\"=HYPERLINK\") === 0){\n\t\t\t\tvar parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.view.getSelectedId();\n\tvar data = dialog.$dialog.getBody().getValues();\n\n\tvar text = \"\";\n\tif (data.url){\n\t\tdata.name = data.name || data.url;\n\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\tdata.url = \"http://\" + data.url;\n\t\ttext = `=HYPERLINK(\"${data.url}\",\"${data.name}\")`;\n\t}\n\n\tdialog.view.setCellValue(cell.row, cell.column, text);\n\tdialog.view.refresh();\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:530, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tvar form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:25},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", value: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.apply(this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapply(dialog){\n\t\tvar data = dialog.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(dialog.view, data);\n\t\t\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\n\t\tvar span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tvar item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t\tif(this.textarea.isVisible())\n\t\t\t\t\t\tthis.textarea.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.changeTextarea(text);\n\t\tthis.textarea.show();\n\t\tthis.textarea.focus();\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.group = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\n\t\tconst elements = this.$dialog.getBody().elements;\n\t\tthis.type = elements[\"type\"];\n\t\tthis.size = elements[\"size\"];\n\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.group == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.type.getOption(1).value = webix.i18n.spreadsheet.labels[this.group == \"row\" ? \"height\" : \"width\"];\n\t\tthis.type.setValue(1);\n\t\tthis.type.refresh();\n\n\t\tthis.size.setValue(value);\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst size = this.size.isEnabled() ? this.size.getValue()*1 : \"auto\";\n\n\t\tif(this.group == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\n\t\tthis.close();\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"radio\", name:\"type\", vertical:true, optionHeight:40,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange: id => {\n\t\t\t\t\t\t\t\tif(id == 2)\n\t\t\t\t\t\t\t\t\tthis.size.disable();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tthis.size.enable();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t{id:1, value: \"\"},\n\t\t\t\t\t\t\t{id:2, value: locale[\"fit-content\"]}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{rows: [\n\t\t\t\t\t\t{view:\"text\", name: \"size\", width:120},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as imc from \"./imagecell\";\nimport * as imt from \"./imagetop\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nconst bases = [ imt, imc, asw, rgs, dpd, flt, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n\n\tview.attachEvent(\"onAction\", function(id, values){\n\t\t//hide win when the external ui is removed\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tconst box = dialogs[\"add-image-top\"];\n\t\t\tif(box && box.viewid == values.row){\n\t\t\t\tbox.close();\n\t\t\t}\n\t\t}\n\t});\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif (!group || !(prevData && group == prevData.group)){\n\t\t\t\tview.refresh();\n\t\t\t\tview.callEvent(\"onAfterUndo\", []);\n\t\t\t}\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {range, toRange, changeRange} from \"../helpers/column_names\";\nimport {getAccessor} from \"../math/sheet\";\nimport {ignoreUndo} from \"./undo\";\n\nexport function init(view){\n\tconst grid = view._table.$view.querySelector(\".webix_ss_center\");\n\n\tview.views = {\n\t\tregister:function(type, render, track){\n\t\t\tif(!this._types[type])\n\t\t\t\tthis._types[type] = { render:render, track:track };\n\t\t},\n\t\tmove: function(id, x, y){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst old = webix.copy(this._pull[id]);\n\t\t\tthis._pull[id].x = _correctPos(view, win, x, \"x\");\n\t\t\tthis._pull[id].y = _correctPos(view, win, y, \"y\");\n\t\t\tview.callEvent(\"onAction\", [\"move-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t\t_showOne(view, win, this._pull[id]);\n\t\t},\n\t\tadd: function(x, y, type, data, config, id){\n\t\t\tconfig = config || {};\n\t\t\tif(type == \"chart\"){\n\t\t\t\tconfig = webix.extend(config, {\n\t\t\t\t\ttype: \"line\",\n\t\t\t\t\tdataSeries:\"columns\"\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst height =  config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tconst win = webix.ui({ \n\t\t\t\tid:id || \"$ssheet-ui\"+webix.uid(), // fixed id is for undo only\n\t\t\t\tview: \"ssheet-ui\",\n\t\t\t\tcontainer:grid, master:view._table.config.id,\n\t\t\t\twidth:width, height:height\n\t\t\t});\n\n\t\t\twin.attachEvent(\"onViewMoveEnd\", (x, y) => {\n\t\t\t\tconst state = view._table.getScrollState();\n\t\t\t\tthis.move(id, x, y+state.y);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewResize\", () => {\n\t\t\t\tconst conf =  this._pull[id];\n\t\t\t\tconst old = webix.copy(conf);\n\n\t\t\t\tconf.config.height = win.$height;\n\t\t\t\tconf.config.width = win.$width;\n\t\t\t\tview.callEvent(\"onAction\", [\"resize-view\", { row:id, newValue:webix.copy(conf), value:old } ]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewEdit\", () => {\n\t\t\t\tconst config = this._pull[id];\n\t\t\t\tconst command = this._commands[config.type] || config.type;\n\t\t\t\tview.callEvent(\"onCommand\", [{ id:command, viewid:id, config }]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewRemove\", () => this.remove(id));\n\n\t\t\tid = win.config.id;\n\n\t\t\tx = _correctPos(view, win, x, \"x\");\n\t\t\ty = _correctPos(view, win, y, \"y\");\n\n\t\t\tthis._pull[id] = { x, y, type, data, config };\n\t\t\tthis.update(id, data, config, true);\n\t\t\t_showOne(view, win, this._pull[id]);\n\n\t\t\treturn id; \n\t\t},\n\t\tremove: function(id){\n\t\t\tconst old = this._pull[id];\n\t\t\twebix.$$(id).close();\n\t\t\tdelete this._pull[id];\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:null, value:old } ]);\n\t\t},\n\t\tget:function(id){\n\t\t\treturn webix.$$(id).getBody();\n\t\t},\n\t\tgetConfig:function(id){\n\t\t\treturn this._pull[id];\n\t\t},\n\t\tupdate:function(id, data, config, inner){\n\t\t\tconst old = inner ? null : webix.copy(this._pull[id]);\n\t\t\tconst conf = this._pull[id];\n\t\t\tconst actions = this._types[conf.type];\n\n\t\t\tdata = data || config.data || \"\";\n\t\t\tconfig = config || {};\n\n\t\t\tdelete config.data;\n\n\t\t\tif(conf.type == \"chart\"){\n\t\t\t\tconst type = config.type;\n\t\t\t\tif(type && !_isPie(type) && !config.series){\n\t\t\t\t\tconst xAxis = config.xAxis && config.xAxis.range;\n\t\t\t\t\tconst legend = config.legend && config.legend.range;\n\t\t\t\t\tconfig.series = _getSeries(view, data, config.dataSeries, {xAxis, legend});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst win = webix.$$(id);\n\n\t\t\tconst height = config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tif(win.$width != width && win.$height != height){\n\t\t\t\twin.define({width, height});\n\t\t\t\twin.resize();\n\t\t\t}\n\n\t\t\tconf.data = data;\n\t\t\tconf.config = config;\n\n\t\t\tlet node = this.get(id);\n\n\t\t\tdata = _fromRange(view, conf);\n\n\t\t\tif(actions.render){\n\t\t\t\tconst renderConfig = webix.copy(conf);\n\n\t\t\t\t//clear width and height for inner view resizing\n\t\t\t\trenderConfig.config.width = renderConfig.config.height = 0;\n\n\t\t\t\tnode = actions.render(node, renderConfig, data);\n\t\t\t\t_processTables(node);\n\t\t\t}\n\n\t\t\tif(actions.track)\n\t\t\t\t_trackOne(view, node, actions.track, conf);\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t},\n\t\t_commands:{\n\t\t\t\"image\":\"add-image-top\",\n\t\t\t\"chart\":\"add-chart\"\n\t\t},\n\t\t_types:{},\n\t\t_pull:{}\n\t};\n\n\t// handle events\n\tview._table.attachEvent(\"onResize\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollY\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollX\", () => _showAll(view) );\n\n\tview.attachEvent(\"onReset\", () => _reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tconst move = type === \"move-view\";\n\t\tif (move || type == \"resize-view\" || type === \"add-view\")\n\t\t\t_undoUI(view, move, row, value);\n\t});\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif(action == \"header-hide\")\n\t\t\t_showAll(view);\n\t\telse if(action == \"before-grid-change\")\n\t\t\t_updateData(view, p.name, p.inc, p.data, p.start);\n\t});\n\tview.attachEvent(\"onColumnOperation\", () =>  _showAll(view, true));\n\tview.attachEvent(\"onRowOperation\", () => _showAll(view, true));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\tview.attachEvent(\"onCellChange\", () => _trackAll(view));\n\tview.attachEvent(\"onMathRefresh\", () => _trackAll(view));\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\tfor(let i in view.views._pull) webix.$$(i).destructor();\n\t});\n\n\t// set default views\n\tview.views.register(\"chart\", (node, conf, data) => {\n\t\tconst dataRange = _getNames(view, conf);\n\t\tconst config = _genChartConfig(conf, data, dataRange);\n\t\treturn webix.ui(config, node);\n\t}, (view, data) => {\n\t\tview.clearAll();\n\t\tview.parse(data);\n\t});\n\n\tview.views.register(\"image\", (node, conf, data) => {\n\t\tconst config = webix.extend({ css:\"webix_ssheet_bgimage\", template:`<img src=\"${data}\"/>` }, conf.config||{}, true );\n\t\treturn webix.ui(config, node);\n\t});\n}\n\nfunction _parse(view, data){\n\twebix.delay(function(){ //[fixme] wait for dom, otherwise legend is misplaced https://tracker.webix.io/issue/WS-1318\n\t\tconst views = data.views;\n\t\tif(views){\n\t\t\tignoreUndo(function(){\n\t\t\t\tviews.forEach(obj => view.views.add.apply(view.views, obj));\n\t\t\t}, view);\n\t\t}\n\t});\n}\n\nfunction _serialize(view, data, config){\n\tdata.views = [];\n\tfor(let i in view.views._pull){\n\t\tconst conf = view.views._pull[i];\n\t\tconst one = [conf.x, conf.y, conf.type, conf.data, conf.config];\n\t\tif(config && config.viewIds)\n\t\t\tone.push(i);\n\t\tdata.views.push(one);\n\t}\n}\n\nlet thread;\nfunction _trackAll(view){\n\tclearTimeout(thread);\n\tthread = webix.delay(() => {\n\t\tconst ui = view.views;\n\t\tfor(let id in ui._pull){\n\t\t\tconst track = ui._types[ui._pull[id].type].track;\n\t\t\tif(track){\n\t\t\t\t_trackOne(view, ui.get(id), track, ui._pull[id]);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _trackOne(view, node, track, conf){\n\tconst data = _fromRange(view, conf, true);\n\ttrack(node, data);\n}\n\nfunction _updateData(view, name, inc, data, start){\n\tconst views = data.views;\n\tfor(let i = 0; i < views.length; i++){\n\t\tif(_isRange(views[i][3]))\n\t\t\tviews[i][3] = changeRange(views[i][3], name, inc, start);\n\t}\n} \n\nfunction _showAll(view, pos){\n\t//close possibly open menus of embedded ui\n\twebix.callEvent(\"onClick\", []);\n\n\tfor(let id in view.views._pull){\n\t\tconst win = webix.$$(id);\n\t\tconst conf = view.views._pull[id];\n\t\tif(pos){\n\t\t\tconf.x = _correctPos(view, win, conf.x, \"x\");\n\t\t\tconf.y = _correctPos(view, win, conf.y, \"y\");\n\t\t}\n\t\t_showOne(view, win, conf);\n\t}\n}\n\nfunction _showOne(view, win, conf){\n\tconst state = view._table.getScrollState();\n\n\twin.show({\n\t\tx:conf.x,\n\t\ty:conf.y-state.y\n\t});\n}\n\nfunction _correctPos(view, win, v, type){\n\tif(!v && v !==0 )\n\t\tv = view._table.getScrollState()[type]+50;\n\telse{\n\t\tconst size = type == \"x\" ? _getWidth(view)-win.$width : _getHeight(view)-win.$height;\n\t\tv = Math.min(Math.max(v, 0), size);\n\t}\t\n\treturn v;\n}\n\nfunction _reset(view){\n\tignoreUndo(function(){\n\t\tfor(let id in view.views._pull)\n\t\t\tview.views.remove(id);\n\t}, view);\n}\n\nfunction _undoUI(view, move, id, value){\n\tif(value){\n\t\tconst {x, y, type, data, config} = value;\n\t\tif(view.views._pull[id]){\n\t\t\tif(move)\n\t\t\t\tview.views.move(id, x, y);\n\t\t\telse\n\t\t\t\tview.views.update(id, data, config);\n\t\t}\n\t\telse\n\t\t\tview.views.add(x, y, type, data, config, id);\n\n\t\tconst editor = view.$$(\"chartEditor\");\n\t\tif(editor && editor.viewId == id)\n\t\t\teditor.queryView(\"form\").setValues(config);\n\t}\n\telse\n\t\tview.views.remove(id);\n}\n\nfunction _getWidth(view){\n\tlet width = 0;\n\tview._table.eachColumn(function(id){\n\t\tif(id !== \"rowId\")\n\t\t\twidth += this.getColumnConfig(id).width;\n\t});\n\treturn width;\n}\n\nfunction _getHeight(view){\n\tlet height = 0;\n\tview._table.data.each(function(obj){\n\t\theight += obj.$height || webix.skin.$active.rowHeight;\n\t});\n\treturn height;\n}\n\n//disable datatables not to interfere with ss table events\nfunction _processTables(node){\n\tconst query = function(view){\n\t\treturn view.name == \"datatable\" || view.name == \"treetable\";\n\t};\n\tlet tables = node.queryView(query, \"self\");\n\tif(tables) tables = [tables];\n\telse tables = node.queryView(query, \"all\");\n\ttables.forEach((dt) => dt.disable());\n}\n\n/* chart-specific helpers */\n\nfunction _genChartConfig(conf, data, dataRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tlet config = webix.copy(conf.config);\n\n\tconfig = _normalizeConfig(config);\n\n\tconst scale = config.scale.lines;\n\tconst scaleColor = config.scale.color || undefined;\n\n\tconst type = config.type;\n\n\tif(_isPie(type))\n\t\tdelete config.series;\n\n\tconst legendConfig = config.legend;\n\tlet legendRange = !legendConfig.fromData && legendConfig.range;\n\tif(legendRange){\n\t\tconst switchDirection =  config.dataSeries == \"rows\";\n\t\tlegendRange = _getParts(legendConfig.range, switchDirection, dataRange);\n\t}\n\n\tconst legend = {\n\t\talign: legendConfig.align || \"center\",\n\t\tvalign: legendConfig.valign || \"bottom\"\n\t};\n\n\tlegend.layout = legend.valign == \"middle\" ? \"y\" : \"x\";\n\n\tif(_isPie(type))\n\t\t_pieConfig(data, config, legend, legendRange);\n\telse if(config.series){\n\t\tlegend.values = [];\n\n\t\tconst lines = config.series;\n\t\tconfig.series = [];\n\n\t\tconst xAxis = config.xAxis;\n\t\tif(xAxis.fromData)\n\t\t\txAxis.range = legendRange ? Object.keys(data[0]).filter(line => legendRange.indexOf(line) == -1)[0] : \"data0\";\n\t\telse if(xAxis.range)\n\t\t\txAxis.range = dataRange[xAxis.range];\n\n\t\tfor(let i = 0; i < lines.length; i++){\n\t\t\tconst color = lines[i].color;\n\t\t\tconst item = dataRange[lines[i].range];\n\n\t\t\tif(item != xAxis.range){\n\t\t\t\tconst s = {\n\t\t\t\t\tvalue:`#${item}#`,\n\t\t\t\t\ttooltip:{\n\t\t\t\t\t\ttemplate: lines[i].tooltip ? `#${item}#` : \"\"\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif(type == \"radar\" || type == \"line\" || type == \"spline\"){\n\t\t\t\t\ts.line = { color:color };\n\t\t\t\t\ts.item = { borderColor:color, type:lines[i].marker };\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\ts.color = color;\n\t\t\t\tif(type == \"area\" || type == \"splineArea\")\n\t\t\t\t\ts.alpha = 0.7;\n\n\t\t\t\tif(legendRange || legendConfig.fromData){\n\t\t\t\t\tconst val = legendRange ? data[0][legendRange[i]] : data[0][item];\n\t\t\t\t\tconst text = (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t\tlegend.values.push({text, color});\n\t\t\t\t}\n\n\t\t\t\tconfig.series.push(s);\n\t\t\t}\n\t\t}\n\n\t\tif(xAxis.range){\n\t\t\tconfig.xAxis = {\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tconst val = obj[xAxis.range];\n\t\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t},\n\t\t\t\ttitle: config.xAxis.title,\n\t\t\t\tlineColor: scaleColor,\n\t\t\t\tcolor: scaleColor,\n\t\t\t\tlines: scale\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\tdelete config.xAxis;\n\n\t\tif(legend.values.length)\n\t\t\tconfig.legend = legend;\n\t\telse\n\t\t\tdelete config.legend;\n\t}\n\n\tconfig.yAxis = webix.extend(config.yAxis||{}, {\n\t\tlineColor: scaleColor,\n\t\tcolor: scaleColor,\n\t\tlines: scale,\n\t\tlineShape: config.scale.circle ? \"arc\" : \"default\"\n\t});\n\n\treturn webix.extend({\n\t\tview:\"chart\"\n\t}, config, true);\n}\n\nfunction _pieConfig(data, config, legend, legendRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tfor(var i in data[0]){\n\t\tif(config.legend.fromData){\n\t\t\tlegend.template = obj => {\n\t\t\t\tconst val = obj[i];\n\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t}; //data0\n\t\t\tconfig.value = `#${i.replace(\"0\", \"1\")}#`; //data1\n\t\t}\n\t\telse{\n\t\t\tif(config.legend.range)\n\t\t\t\tlegend.template = obj => {\n\t\t\t\t\tconst val = obj[legendRange[0]];\n\t\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t};\n\t\t\tconfig.value = `#${i}#`;\n\t\t}\n\t\tbreak; \n\t}\n\tif(legend.template)\n\t\tconfig.legend = legend;\n\telse\n\t\tdelete config.legend;\n\n\tif(config.pieInnerText)\n\t\tconfig.pieInnerText = config.value;\n}\n\nfunction _isRange(data){\n\treturn typeof data == \"string\" && data.indexOf(\"data:image\") === -1;\n}\n\nfunction _fromRange(view, conf, parse){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn data;\n\n\tconst arr = [];\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = data.split(\",\");\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = getAccessor(view, cells[4]);\n\t\t\t\tcells[4] = lastIndex;\n\n\t\t\t\tconst subdata = page ? page[switchDirection ? \"getRangeRows\" : \"getRangeCols\"].apply(page, cells) : null;\n\t\t\t\tif(subdata){\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\tfor(let i = 0; i < subdata[0].length; i++){\n\t\t\t\t\t\tif(!arr[i])\n\t\t\t\t\t\t\tarr[i] = {};\n\t\t\t\t\t\twebix.extend(arr[i], subdata[0][i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(parse && config && !_isPie(config.type)){\n\t\t\tif(typeof(config.legend) != \"object\")\n\t\t\t\tconfig.legend = {fromData: !!config.legend};\n\n\t\t\tconst legend = config.legend;\n\n\t\t\tif(legend.fromData)\n\t\t\t\tarr.shift();\n\t\t\telse if(legend.range){\n\t\t\t\tconst names = _getNames(view, conf);\n\t\t\t\tconst legendRange = _getParts(legend.range, switchDirection, names);\n\t\t\t\tfor (let i = 0; i < legendRange.length; i++){\n\t\t\t\t\tconst item = legendRange[i];\n\t\t\t\t\tdelete arr[0][item];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn arr;\n}\n\nfunction _getNames(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn;\n\n\tlet names = {};\n\tif(data){\n\t\tconst config = conf.config;\n\t\tlet lastIndex = 0;\n\t\tdata = data.split(\",\");\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = getAccessor(view, cells[4]);\n\t\t\t\tcells[4] = lastIndex;\n\n\t\t\t\tconst subdata = page ? page[config.dataSeries == \"rows\" ? \"getRangeRows\" : \"getRangeCols\"].apply(page, cells) : null;\n\t\t\t\tif(subdata){\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\twebix.extend(names, subdata[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn names;\n}\n\nexport function _isPie(type){\n\treturn /pie|donut/.test(type);\n}\n\nexport function _getSeries(view, data, dataSeries, active){\n\tconst dir = dataSeries == \"rows\";\n\tlet vals = [];\n\n\tif(data){\n\t\tlet xAxis = [];\n\t\tlet legend = [];\n\t\tlet activeVals = [];\n\n\t\tif(active){\n\t\t\tif(active.legend)\n\t\t\t\tlegend = _getParts(active.legend, dir);\n\t\t\tif(active.xAxis)\n\t\t\t\txAxis = _getParts(active.xAxis, dir);\n\t\t\tif(active.series)\n\t\t\t\tactiveVals = active.series.filter(val => legend.indexOf(val.range) == -1 && xAxis.indexOf(val.range) == -1);\n\t\t}\n\n\t\tdata = data.split(\",\");\n\t\tlet colorIndex = 0;\n\t\tdata.forEach(subdata => {\n\t\t\tconst series = range(subdata, view);\n\t\t\tif(series){\n\t\t\t\tconst start = dir ? series[0] : series[1];\n\t\t\t\tconst end = dir ? series[2] : series[3];\n\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tif(legend.indexOf(range) != -1 || xAxis.indexOf(range) != -1)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tconst activeVal = activeVals.filter(val => val.range == range);\n\n\t\t\t\t\tvals.push(activeVal[0] || {\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tmarker: \"square\",\n\t\t\t\t\t\ttooltip: 1,\n\t\t\t\t\t\tcolor: _getColor(colorIndex)\n\t\t\t\t\t});\n\n\t\t\t\t\tcolorIndex++;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn vals;\n}\n\nexport function _getParts(ranges, dir, dataRange){\n\tconst parts = [];\n\n\tranges = ranges.split(\",\");\n\tranges.forEach(subRange => {\n\t\tsubRange = range(subRange);\n\t\tconst start = dir ? subRange[0] : subRange[1];\n\t\tconst end = dir ? subRange[2] : subRange[3];\n\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst range = dir ?\n\t\t\t\ttoRange(i, subRange[1], i, subRange[3], subRange[4]):\n\t\t\t\ttoRange(subRange[0], i, subRange[2], i, subRange[4]);\n\n\t\t\tparts.push(dataRange ? dataRange[range] : range);\n\t\t}\n\t});\n\n\treturn parts;\n}\n\nexport function _normalizeConfig(config){\n\tif(typeof(config.xAxis) != \"object\")\n\t\tconfig.xAxis = {fromData: !!config.xAxis};\n\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconfig.legend = webix.extend(config.legend, {\n\t\tlayout:\"x\",\n\t\talign:\"center\",\n\t\tvalign:\"bottom\"\n\t});\n\n\tif(!config.scale)\n\t\tconfig.scale = {\n\t\t\tlines:1\n\t\t};\n\n\treturn config;\n}\n\nfunction _getColor(index){\n\tconst colors = [\n\t\t\"#e06666\", \"#6aa84f\", \"#3c78d8\", \"#e69138\", \"#783f04\", \"#134f5c\", \"#674ea7\", \"#c27ba0\"\n\t];\n\treturn colors[index%colors.length];\n}","import {range, toRange} from \"./helpers/column_names\";\nimport {_getSeries, _isPie, _normalizeConfig} from \"./operations/views\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tconst activeSkin = webix.skin.$active;\n\tconst padding = activeSkin.dataPadding-2;\n\tconst margin = activeSkin.layoutMargin.form;\n\n\treturn {\n\t\twidth:420,\n\t\thidden: true,\n\t\tid:\"chartEditor\",\n\t\tcss:\"ssheet_chart\",\n\t\trows:[\n\t\t\t{\n\t\t\t\theight: activeSkin.barHeight,\n\t\t\t\tcss: \"ssheet_chart_wizard_head\",\n\t\t\t\tpadding:{ left: 2 },\n\t\t\t\tcols: [\n\t\t\t\t\t{ view: \"icon\", icon:\"webix_ssheet_icon ssi-arrow-left\", click: () => closeEditor(view)  },\n\t\t\t\t\t{ type:\"header\", borderless:true, template: labels[\"chart-edit\"] }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"form\",\n\t\t\t\tcomplexData:true,\n\t\t\t\tborderless: true,\n\t\t\t\tpadding:{\n\t\t\t\t\ttop: 0\n\t\t\t\t},\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\telements:[{\n\t\t\t\t\tview:\"tabview\",\n\t\t\t\t\tid:\"chartTabs\",\n\t\t\t\t\tcells:[\n\t\t\t\t\t\t{ id:\"common\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-common\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\taddRichselect(\"type\", \"chart-type\", getTypes()),\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"stacked-chart\"], name:\"stacked\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-3d\"], name:\"3D\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-col-xAxis\"], name:\"xAxis.fromData\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-text\"], name:\"pieInnerText\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-row-legend\"], name:\"legend.fromData\"},\n\t\t\t\t\t\t\t\t\t{ view:\"radio\", label:labels[\"chart-data-from\"], name:\"dataSeries\", vertical:true, options:[\n\t\t\t\t\t\t\t\t\t\t{id:\"columns\", value:labels[\"chart-columns\"]},\n\t\t\t\t\t\t\t\t\t\t{id:\"rows\", value:labels[\"chart-rows\"]}\n\t\t\t\t\t\t\t\t\t]},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"advanced\", borderless:true, type:\"form\", paddingX:0, padding:{bottom:0}, header:labels[\"chart-series\"], rows:[\n\t\t\t\t\t\t\t{ view: \"ssheet-series\", name:\"series\" },\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"extras\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-extras\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\t\t\t\tmulti: true,\n\t\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-legend\"], body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view: \"text\", label:labels[\"chart-legend-range\"], name:\"legend.range\"},\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.align\", \"chart-legend-align\", getLegendAlign()),\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.valign\", \"chart-legend-valign\", getLegendValign())\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-axis\"], body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-range\"], name:\"xAxis.range\", range:true, batch:\"axis\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-title\"], name:\"xAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-title\"], name:\"yAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-scale\"], name:\"scale.lines\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-radar-circle\"], name:\"scale.circle\", hidden:true},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-scale-color\"], name:\"scale.color\", batch:\"axis\"}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}]\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tconst form = chartEditor.queryView(\"form\");\n\tconst elements = form.elements;\n\n\tview.attachEvent(\"onCommand\", action => {\n\t\tif(action.id == \"add-chart\"){\n\t\t\tconst config = action.config;\n\t\t\tlet values = config && config.config || {};\n\n\t\t\tchartEditor.viewId = action.viewid;\n\t\t\tchartEditor.show();\n\n\t\t\tview.$handleSelection = function(st, end, a, b){\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\n\t\t\t\tif(chartEditor.queryView(view => view == focus)){\n\t\t\t\t\tif(focus == elements.range || focus == elements[\"legend.range\"]){\n\t\t\t\t\t\tlet val = focus.getValue();\n\t\t\t\t\t\tconst last = val.lastIndexOf(\",\");\n\n\t\t\t\t\t\tval = last == -1 ? \"\" : val.substring(0, last + 1);\n\t\t\t\t\t\tfocus.setValue(val + a+\":\"+b);\n\t\t\t\t\t}\n\t\t\t\t\telse if(focus.config.range)\n\t\t\t\t\t\tfocus.setValue(a+\":\"+b);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tform.clear();\n\t\t\tview.$$(\"chartTabs\").setValue(\"common\");\n\n\t\t\tvalues = _normalizeConfig(values);\n\n\t\t\tvalues.range = config ? config.data : view.getSelectedRange();\n\t\t\tchartEditor.viewId = action.viewid ? action.viewid : view.views.add(null, null, \"chart\", values.range, values);\n\n\t\t\tupdateValign(values.legend.align);\n\t\t\tupdateAlign(values.legend.valign);\n\t\t\tupdateType(values.type);\n\n\t\t\tform.setValues(inValues(values));\n\n\t\t\tif(values.legend.fromData)\n\t\t\t\tupdateLegendRange(values.legend.fromData);\n\t\t\tif(values.xAxis.fromData)\n\t\t\t\tupdateXaxisRange(values.xAxis.fromData);\n\n\t\t\tupdateSeries();\n\n\t\t\tform.queryView(\"accordionitem\", \"all\").forEach(view => view.expand());\n\n\t\t\telements.range.focus();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (id, values) => {\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tif(chartEditor.isVisible() && chartEditor.viewId == values.row)\n\t\t\t\tcloseEditor(view);\n\t\t}\n\t});\n\n\tform.attachEvent(\"onChange\", function(val, oldVal){\n\t\tswitch (this.$eventSource){\n\t\t\tcase elements.type:\n\t\t\t\tupdateType(val);\n\t\t\t\tbreak;\n\t\t\tcase elements.range:\n\t\t\tcase elements.dataSeries:\n\t\t\t\tif(this.$eventSource == elements.dataSeries)\n\t\t\t\t\tswitchRowsCols();\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\thandlePieLegend();\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.range\"], getLeftColumn());\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.fromData\"]:\n\t\t\t\tupdateXaxisRange(val);\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.fromData\"]:\n\t\t\t\tupdateLegendRange(val);\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.align\"]:\n\t\t\t\tupdateValign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.valign\"]:\n\t\t\t\tupdateAlign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.range\"]:\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.range\"]:\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"legend.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst config = outValues(form.getValues());\n\t\tview.views.update(chartEditor.viewId, config.range, config);\n\t});\n\n\telements.series.attachEvent(\"onRangeChange\", updateRange);\n\n\tfunction handlePieLegend(){\n\t\tif(elements[\"legend.fromData\"].getValue()){\n\t\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\t\tsetSilentValue(elements[\"legend.range\"], handler());\n\t\t}\n\t}\n\n\tfunction updateLegendRange(val){\n\t\tif(val){\n\t\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\t\tupdateRange(\"\", legendRange);\n\t\t}\n\n\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\tval = val ? handler() : \"\";\n\n\t\tsetSilentValue(elements[\"legend.range\"], val);\n\t}\n\n\tfunction updateXaxisRange(val){\n\t\tif(val){\n\t\t\tconst xAxisRange = elements[\"xAxis.range\"].getValue();\n\t\t\tupdateRange(\"\", xAxisRange);\n\t\t}\n\n\t\tval = val ? getLeftColumn() : \"\";\n\n\t\tsetSilentValue(elements[\"xAxis.range\"], val);\n\t}\n\n\tfunction setSilentValue(element, val){\n\t\telement.blockEvent();\n\t\telement.setValue(val);\n\t\telement.unblockEvent();\n\t}\n\n\tfunction getLeftColumn(){\n\t\tconst data = elements.range.getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\tlet leftColumn = \"\";\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend: legendRange || \"\"});\n\n\t\tif(series.length)\n\t\t\tleftColumn = series[0].range;\n\n\t\treturn leftColumn;\n\t}\n\n\tfunction getTopRow(){\n\t\tconst data = elements.range.getValue().split(\",\");\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst xAxisRange = elements[\"xAxis.range\"].getValue().split(\",\");\n\t\tlet topRow = [];\n\n\t\tdata.forEach(subdata => {\n\t\t\tif(xAxisRange.indexOf(subdata) == -1){\n\t\t\t\tconst part = range(subdata, view);\n\t\t\t\tif(part){\n\t\t\t\t\tconst range = dir ?\n\t\t\t\t\t\ttoRange(part[0], part[1], part[2], part[1], part[4]) :\n\t\t\t\t\t\ttoRange(part[0], part[1], part[0], part[3], part[4]);\n\n\t\t\t\t\tif(data.indexOf(range) == -1)\n\t\t\t\t\t\ttopRow.push(range);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn topRow.join(\",\");\n\t}\n\n\tfunction updateRange(val, oldVal){\n\t\tlet data = elements.range.getValue();\n\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend, xAxis});\n\n\t\toldVal = oldVal.split(\",\");\n\n\t\tdata = data.split(\",\").filter(val => oldVal.indexOf(val) == -1);\n\n\t\tif(val){\n\t\t\tval = val.split(\",\");\n\t\t\tval.forEach(range => {\n\t\t\t\tconst exist = series.filter(obj => obj.range == range);\n\t\t\t\tif(!exist.length)\n\t\t\t\t\tdata.push(range);\n\t\t\t});\n\t\t}\n\n\t\tsetSilentValue(elements.range, data.join(\",\"));\n\t}\n\n\tfunction updateAlign(val){\n\t\tconst align = elements[\"legend.align\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"middle\"){\n\t\t\tif(list.exists(\"center\"))\n\t\t\t\tlist.remove(\"center\");\n\t\t}\n\t\telse if(!list.exists(\"center\"))\n\t\t\tlist.add({id:\"center\", value:labels[\"chart-legend-center\"]}, 1);\n\t}\n\n\tfunction updateValign(val){\n\t\tconst align = elements[\"legend.valign\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"center\"){\n\t\t\tif(list.exists(\"middle\"))\n\t\t\t\tlist.remove(\"middle\");\n\t\t}\n\t\telse if(!list.exists(\"middle\"))\n\t\t\tlist.add({id:\"middle\", value:labels[\"chart-legend-middle\"]}, 1);\n\t}\n\n\tfunction updateType(val){\n\t\tconst tabs = view.$$(\"chartTabs\").getTabbar();\n\t\tswitchRowsCols();\n\t\thandlePieLegend();\n\n\t\telements.series.hideMarkers(val == \"radar\" || val == \"line\" || val == \"spline\");\n\n\t\tif(val == \"area\" || val == \"bar\") elements.stacked.show();\n\t\telse hideField(elements.stacked);\n\n\t\tif(val == \"radar\")\n\t\t\telements[\"scale.circle\"].show();\n\t\telse\n\t\t\thideField(elements[\"scale.circle\"]);\n\n\t\tif(val == \"pie\")\n\t\t\telements[\"3D\"].show();\n\t\telse\n\t\t\thideField(elements[\"3D\"]);\n\n\t\tif(_isPie(val)){\n\t\t\thideBatch(\"axis\");\n\t\t\telements.pieInnerText.show();\n\t\t\ttabs.hideOption(\"advanced\");\n\t\t}\n\t\telse{\n\t\t\thideBatch(\"axis\", true);\n\t\t\thideField(elements.pieInnerText);\n\t\t\ttabs.showOption(\"advanced\");\n\t\t}\n\n\t\tif(_isPie(val) || val == \"radar\")\n\t\t\thideBatch(\"axisTitle\");\n\t\telse\n\t\t\thideBatch(\"axisTitle\", true);\n\t}\n\n\tfunction updateSeries(){\n\t\tlet data = elements.range.getValue();\n\n\t\tlet series = elements.series.getValue();\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tseries = _getSeries(view, data, dataSeries, {series, legend, xAxis});\n\n\t\telements.series.setValue(series);\n\t}\n\n\tfunction switchRowsCols(){\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst pie = _isPie(elements.type.getValue());\n\t\tif((!pie && dir) || (!dir && pie)){\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-col-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-row-xAxis\"]);\n\t\t}\n\t\telse{\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-row-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-col-xAxis\"]);\n\t\t}\n\t\telements[\"legend.fromData\"].refresh();\n\t\telements[\"xAxis.fromData\"].refresh();\n\t}\n\n\tfunction hideField(field){\n\t\tif(field.setValue)\n\t\t\tsetSilentValue(field);\n\t\tfield.hide();\n\t}\n\n\tfunction hideBatch(batch, visible){\n\t\tform.queryView({batch:batch}, \"all\").forEach(field => {\n\t\t\tif(visible)\n\t\t\t\tfield.show();\n\t\t\telse\n\t\t\t\thideField(field);\n\t\t});\n\t}\n\n\tfunction inValues(values){\n\t\tif(/stacked|3D/.test(values.type))\n\t\t\tvalues.type = values.type.replace(/stacked|3D/, \"\").toLowerCase();\n\t\treturn values;\n\t}\n\n\tfunction outValues(values){\n\t\tif(values.stacked)\n\t\t\tvalues.type = \"stacked\"+values.type.charAt(0).toUpperCase()+values.type.substr(1);\n\t\telse if(values[\"3D\"])\n\t\t\tvalues.type += \"3D\";\n\n\t\treturn values;\n\t}\n}\n\nfunction closeEditor(view){\n\tview.$$(\"chartEditor\").viewId = null;\n\tview.$handleSelection = null;\n\tview.$$(\"chartEditor\").hide();\n}\n\nfunction addRichselect(name, label, data){\n\treturn { view: \"richselect\", name:name, label:labels[label], suggest:{\n\t\tview: \"ssheet-form-suggest\",\n\t\tdata: data\n\t}};\n}\n\nfunction getTypes(){\n\treturn [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"radar\", value:labels[\"radar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]},\n\t\t{id:\"donut\", value:labels[\"donut-chart\"]}\n\t];\n}\n\nfunction getLegendAlign(){\n\treturn [\n\t\t{id:\"left\", value:labels[\"chart-legend-left\"]},\n\t\t{id:\"center\", value:labels[\"chart-legend-center\"]},\n\t\t{id:\"right\", value:labels[\"chart-legend-right\"]}\n\t];\n}\n\nfunction getLegendValign(){\n\treturn [\n\t\t{id:\"top\", value:labels[\"chart-legend-top\"]},\n\t\t{id:\"middle\", value:labels[\"chart-legend-middle\"]},\n\t\t{id:\"bottom\", value:labels[\"chart-legend-bottom\"]}\n\t];\n}","import {updateMath}  from \"../math/updater\";\nimport {clearMathCache} from \"../math/cache\";\nimport {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif(action == \"grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tloadChangedData(view,value);\n\t\t}\n\t});\n}\n\nexport function process(action, start, end, view, e, r) {\n\tvar data, i, newData, oldData, values,\n\t\tcount=0, origin=0;\n\n\tvar select = view._table.getSelectArea();\n\tvar state = view._table.getScrollState();\n\n\tnewData = view.serialize({\n\t\tmath: true, viewIds:true\n\t});\n\n\toldData = webix.copy(newData);\n\n\tvar spans = newData.spans;\n\tfor (var s in spans){\n\t\tvar span = spans[s];\n\t\tspan = adjustSpan(span, action, start, end, newData.data);\n\t\tif(span[2] <= 0 || span[3] <= 0){\n\t\t\tspans.splice(s, 1);\n\t\t}\n\t}\n\n\tvalues = getUpdateValues(action, start, end);\n\n\tview.$handleSelection = null;\t\n\n\tif(!e)\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\t\tname: values.name,\n\t\t\t\tinc: values.inc,\n\t\t\t\tdata:newData,\n\t\t\t\tstart: start\n\t\t\t}]);\n\t\t},view);\n\n\tdata = newData.data;\n\n\tif (action.group == \"column\") {\n\t\tcount = end.column - start.column + 1;\n\t\torigin = start.column;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delColumn(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t} else if (action.group == \"row\") {\n\t\tcount = end.row - start.row + 1;\n\t\torigin = start.row;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delRow(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t}\n\n\t//update formulas\n\tvar update = { id:action.group, start:origin, count:count };\n\ti = data.length;\n\twhile (i--) {\n\t\tif (data[i][2] && typeof data[i][2] === \"string\" && data[i][2].substr(0, 1) == \"=\")\n\t\t\tdata[i][2] = updateMath(data[i][2], update);\n\t}\n\n\tview.callEvent(\"onAction\", [\"grid-change\",{value: oldData, newValue: newData} ]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tvar grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_column_count = end.column - start.column + 1;\n\tview.config.columnCount += add_column_count;\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column)\n\t\t\tdata[i][1] += add_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]); //add item to history\n\telse\n\t\tdata.push(...value); //recovering value which has been deleted\n}\n\nfunction _delColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_column_count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === del_column_count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tdel_column_count--;\n\t}\n\n\tview.config.columnCount -= del_column_count;\n\n\n\tview.reset();\n\tlet deleted = []; // for history\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column && data[i][1] <= end.column)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][1] > end.column)\n\t\t\tdata[i][1] -= del_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, deleted]);\n}\n\nfunction _addRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_row_count = end.row - start.row + 1;\n\tview.config.rowCount += add_row_count;\n\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][0] >= start.row)\n\t\t\tdata[i][0] += add_row_count;\n\n\tif (!silent) {\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n\t} else {\n\t\tdata.push(...value);\n\t}\n}\n\nfunction _delRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_row_count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === del_row_count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tdel_row_count--;\n\t}\n\n\tview.config.rowCount -= del_row_count;\n\n\tview.reset();\n\n\tlet deleted = [];\n\twhile (i--)\n\t\tif (data[i][0] >= start.row && data[i][0] <= end.row)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][0] > end.row)\n\t\t\tdata[i][0] -= del_row_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, deleted]);\n}","import {methods} from \"./methods\";\nimport * as rgs from \"./ranges\";\nimport * as psh from \"./placeholder\";\nimport {changeRange} from \"../helpers/column_names\";\nimport * as sheets from \"./sheet\";\nimport {_parse, clearMathCache} from \"./cache\";\n\nexport function init(view){\n\tvar triggers = [];\n\tvar backtrak = [];\n\tvar skip_math = false;\n\n\tview._mathSheetCache = {};\n\n\t//math operations object\n\tvar core = get_core(view);\n\n\t//init named ranges\n\tview.ranges = core.ranges = new rgs.Ranges(view);\n\t//init placeholders\n\tcore.p = psh.init(view);\n\n\tview.attachEvent(\"onReset\", () => {\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\t\tskip_math = true;\t// will be reset in onDataParse\n\t\tview.ranges.clear();\n\t});\n\n\tview.attachEvent(\"onCellChange\", updateCell);\n\tview.attachEvent(\"onMathRefresh\", () => {\n\t\trecalckAll();\n\t\tview.$$(\"cells\").refresh();\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tview.ranges.parse(data.ranges);\n\t\tskip_math = false;\n\t\trecalckAll();\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t\t}\n\t});\n\n\tvar solvedMath;\n\tvar solvedCounter;\n\t//execute math handler\n\tfunction applyMath(r, c, handler){\n\t\tconst row = view.getRow(r);\n\t\tconst value = _execute(handler, core);\n\t\trow[c] = value;\n\n\t\tconst tkey = c*100000000+r;\n\t\tconst count = solvedCounter[tkey] = (solvedCounter[tkey] || 0) + 1;\n\n\t\tif (solvedMath[tkey] === value || count > 1000){\n\t\t\t//prevent infinity loops\n\t\t\t//if cell was already calculated with the same value, do not recaculate dependent cells\n\t\t\t//in some cases we have have non-stable loop, where value of math is different each time\n\t\t\t//counter limits calculation for 1000 itterations per cell\n\t\t\treturn;\n\t\t}\n\n\t\tsolvedMath[tkey] = value;\n\t\t//check if we have related cells, process their math as well\n\t\tcheck_trigger(r, c);\n\t}\n\n\t//check and run triggers\n\tfunction check_trigger(srow, scolumn){\n\t\t//triggers is a matrix[row][column]\n\t\t//store array of coordinates of related cells\n\n\t\tconst line = triggers[srow];\n\t\tif (line){\n\t\t\tconst block = line[scolumn];\n\t\t\tif (block){\n\t\t\t\tfor (var i = 0; i < block.length; i++){\n\t\t\t\t\tconst {row, column, handler} = block[i];\n\t\t\t\t\tif (row != srow || column != scolumn){\n\t\t\t\t\t\tapplyMath(row, column, handler);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction recalckAll(){\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar state = grid.getState();\n\t\tvar columns = state.ids.concat(state.hidden);\n\n\t\tgrid.eachRow(function(obj){\n\t\t\tvar item = this.getItem(obj);\n\t\t\tfor (var i=1; i<columns.length; i++){\n\t\t\t\tvar key = columns[i];\n\t\t\t\tvar value = item[\"$\"+key];\n\t\t\t\tif (value)\n\t\t\t\t\trecalckCell(obj, key, value);\n\t\t\t}\n\t\t}, true);\n\t}\n\n\tfunction updateCell(r, c){\n\t\t//cell value can be updated in types module on cell change, so use getCellValue instead of value argument\n\t\trecalckCell(r, c, view.getCellValue(r, c));\n\t}\n\n\tfunction recalckCell(r,c,value){\n\t\t// shortcut processing during data loading\n\t\tif (skip_math && value && typeof value === \"string\" && value.indexOf(\"=\") === 0){\n\t\t\tview.getRow(r)[\"$\"+c] = value;\n\t\t\treturn;\n\t\t}\n\n\t\t//check if changed cell was a math cell, based on some other cells\n\t\t//clean triggers in such case\n\t\tvar line = backtrak[r];\n\t\tif (line && line[c])\n\t\t\tremove_triggers(triggers, backtrak, c, r);\n\n\t\t//if new value is a math, calculate it and store triggers\n\t\tif (value){\n\t\t\tvalue = value.toString();\n\t\t\tif(value.length > 1 && value.indexOf(\"=\") === 0){\n\t\t\t\tvar formula = _parse(value, core, \"\");\n\t\t\t\tvar row = view.getRow(r);\n\t\t\t\trow[c] = _execute(formula.handler, core);\n\t\t\t\trow[\"$\"+c] = formula.text;\n\n\t\t\t\tif (formula.triggers.length){\n\t\t\t\t\tadd_triggers(triggers, backtrak, formula.triggers, \n\t\t\t\t\t\t{ row: r, column: c, handler: formula.handler }, view.getActiveSheet());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//check if we have some other cells, related to the changed one\n\t\tsolvedMath = {};\n\t\tsolvedCounter = {};\n\t\tcheck_trigger(r, c);\n\t}\n\n\tsheets.init(view, core, { parse: _parse, execute: _execute });\n}\n\nexport function calculate(view, value){\n\tvar core = get_core(view);\n\tvar formula = _parse(value, core, \"\");\n\tvalue = _execute(formula.handler, core);\n\treturn value;\n}\n\n//add new triggers\nfunction add_triggers(trs, back, adds, cell, active){\n\t//trs - matrix of triggers\n\t//back - matrix of backlinks\n\t//adds - list of triggers\n\tvar blist = [];\n\tfor (var i = 0; i < adds.length; i++){\n\t\tvar line = adds[i];\n\t\t//line = [start_row, start_column, end_row, end_column, sheet]\n\n\t\t//ignore triggers from passive cells\n\t\tif (line[4] !== \"\" && line[4] !== active)\n\t\t\tcontinue;\n\n\t\tfor (var j = line[0]; j<=line[2]; j++){\n\t\t\tvar step = trs[j];\n\t\t\tif (!step) step = trs[j]=[];\n\t\t\tfor (var k = line[1]; k <= line[3]; k++){\n\t\t\t\tvar block = step[k];\n\t\t\t\tif (!block)\n\t\t\t\t\tblock = step[k] = [];\n\n\t\t\t\tblist.push([j, k]);\n\t\t\t\tblock.push(cell);\n\t\t\t}\n\t\t}\n\t}\n\n\t//store back-relations, for easy trigger removing \n\tadd_backtrack(back, cell.row, cell.column, blist);\n}\n\n//store backtrack relations as a matrix\nfunction add_backtrack(back, row, column, adds){\n\tvar line = back[row];\n\tif (!line)\n\t\tline = back[row] = [];\n\tline[column] = adds;\n}\n\n//remove unused triggers\nfunction remove_triggers(trs, back, c, r){\n\t//get list of triggers from backtrack structure\n\tvar adds = back[r][c];\n\tback[r][c] = null;\n\n\t//delete triggers\n\tfor (var i = adds.length - 1; i >= 0; i--) {\n\t\tvar cell = adds[i];\n\t\tvar block = trs[cell[0]][cell[1]];\n\n\t\tfor (var j = block.length-1; j >= 0; j--){\n\t\t\tvar bcell = block[j];\n\t\t\tif (bcell.row == r && bcell.column == c)\n\t\t\t\tblock.splice(j,1);\n\t\t}\n\t}\n}\n\n//run math function\nfunction _execute(formula, core){\n\tvar value;\n\tvar error = webix.i18n.spreadsheet.table[\"math-error\"];\n\ttry {\n\t\tvalue = formula.call(core);\t\n\t} catch(e){\n\t\t//some error in the math code\n\t\treturn error;\n\t}\n\n\tif (typeof value === \"number\"){\n\t\tif(!isFinite(value)) return error;\n\t\t//round values to fix math precision issue in JS\n\t\treturn Math.round(value*100000)/100000;\n\t} else if (typeof value !== \"string\"){\n\t\treturn value ? value.toString() : error;\n\t} else\n\t\treturn value;\n}\n\n//converts cell references to code\nfunction get_core(view){\n\tvar active = sheets.getAccessor(view);\n\n\treturn {\n\t\trs:function(sheet, r1, c1, r2, c2){\n\t\t\treturn sheets.getAccessor(view, sheet).getRange(r1,c1,r2,c2);\n\t\t},\n\t\tr:active.getRange,\n\t\tvs:function(sheet, r, c){\n\t\t\treturn sheets.getAccessor(view, sheet).getValue(r,c);\n\t\t},\n\t\tv:active.getValue,\n\t\tm:methods,\n\t\tp:{},\n\t\te:function(e){throw e;}\n\t};\n}\n\nfunction _serialize(view, obj){\n\tobj.ranges = view.ranges.serialize();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tvar ranges = data.ranges;\n\tfor(let i=0; i < ranges.length; i++)\n\t\tranges[i][1] = changeRange(ranges[i][1],name,inc, start);\n}","export function init(view){\n\tvar holders = {};\n\n\tview.setPlaceholder = function(obj, value){\n\t\tif (typeof obj === \"object\")\n\t\t\tfor (var key in obj)\n\t\t\t\tholders[key.toLowerCase()] = obj[key];\n\t\telse\n\t\t\tholders[obj.toString().toLowerCase()] = value;\n\n\t\tview.callEvent(\"onMathRefresh\",[]);\n\t};\n\n\treturn holders;\n}","import group from \"./undo_group\";\nimport {calculate} from \"../math/math\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: {\n\t\t\t\">\": function(a,b){\n\t\t\t\treturn a > getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<\": function(a,b){\n\t\t\t\treturn a < getCellValue(view, b);\n\t\t\t},\n\t\t\t\"=\": function(a,b){\n\t\t\t\treturn a == getCellValue(view, b);\n\t\t\t},\n\t\t\t\"!=\": function(a,b){\n\t\t\t\treturn a != getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<>\": function(a,b){\n\t\t\t\tvar first = b[0];\n\t\t\t\tvar second = b[1];\n\t\t\t\treturn webix.isArray(b) && a < getCellValue(view, second) && a > getCellValue(view, first);\n\t\t\t}\n\t\t},\n\t\tadd: add,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tget: get,\n\t\tparse: parse,\n\t\tserialize: serialize,\n\t\tclear: clear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onColumnInit\", (column) => _setCssFormat(view, column));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\"){\n\t\t\tvalue = calculate(view, value);\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nfunction _setCssFormat(view,column){\n\tcolumn.cssFormat = function (value, obj, row, column){\n\t\tif (view.conditions._empty) return \"\";\n\n\t\tvar collection, i;\n\t\tcollection = view.conditions.get(row, column);\n\t\tif(!collection)\n\t\t\treturn \"\";\n\n\t\ti = collection.length;\n\t\twhile(i--){\n\t\t\tvar handler = view.conditions.handlers[collection[i][0]];\n\t\t\tif(handler && handler(obj[column],collection[i][1]))\n\t\t\t\treturn collection[i][2];\n\t\t}\n\t\treturn \"\";\n\t};\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tvar c = data[i];\n\t\tvar collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(rowId, columnId, condition, value, style){\n\tvar collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push([condition, value, style]);\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\t\n\t\t\t\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}","import group from \"./undo_group\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../math/ranges\";\nimport * as fmt from \"../operations/formats\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\twebix.extend(col, {row: view.getRow(id.row)}, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { unique:true, order:true, empty:true });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { empty:true });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// update format if editor supports this feature\n\ttable.attachEvent(\"onBeforeEditStop\", function(state, editor, ignore){\n\t\tif (!ignore && editor.getFormat){\n\t\t\tconst value = editor.getValue();\n\t\t\tlet format = editor.getFormat(value);\n\n\t\t\tgroup.set(function(){\n\t\t\t\tview.setCellValue(editor.row, editor.column, value);\n\t\t\t\tif (format){\n\t\t\t\t\tfmt.addFormat(view, editor.row, editor.column, fmt.getFormatSource(format));\n\t\t\t\t} else\n\t\t\t\t\tfmt.removeFormat(view, editor.row, editor.column);\n\t\t\t});\n\n\t\t\tconst cell = view.getSelectedId();\n\t\t\tif (cell && cell.row == editor.row && cell.column == editor.column){\n\t\t\t\tformat = format || \"common\";\n\t\t\t\tformat = fmt.isCustom(format) ? \"custom\" : format;\n\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t\t\t}\n\t\t}\n\t});\n\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup; delete col.row;\n\t});\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"dropdown\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_editor\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor (row in tblEditors){\n\t\tfor (column in tblEditors[row])\n\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tconst editors = data.editors;\n\n\tif (editors)\n\t\tfor (let i=0; i<editors.length; i++)\n\t\t\tview.setCellEditor.apply(view, editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_editor\", false);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function isEditor(view, row, column){\n\tconst editor = view._table._ssEditors;\n\treturn editor[row] && !!editor[row][column];\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(name, inc, data, start){\n\tconst editors = data.editors;\n\n\tif (inc){\n\t\t// create new editors\n\t\tfor(let i=editors.length-1; i>=0; i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete editor mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted){\n\tconst editor = extra.dropdown;\n\n\tview.setCellEditor(row, col, editor);\n\tif (cutted === 1)\n\t\tview.setCellEditor(extra.row, extra.col, {});\n}","import group from \"./undo_group\";\nimport {updateMath} from \"../math/updater\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {pasteDropdown} from \"../operations/dropdown\";\nimport {pasteFilter} from \"../operations/filter\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\t\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.getElementsByClassName(\"webix_clipbuffer\")[0].value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilters();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\tvar newValue = cdata;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math)\n\t\t\tnewValue = updateMath(cdata.math, translate, origin);\n\t\telse \n\t\t\tnewValue = cdata.text;\n\n\t\tif(cdata.style && cdata.style.props){\n\t\t\tconst style = view.addStyle(cdata.style.props);\n\t\t\tview.setStyle(row, col, style);\n\t\t}\n\n\t\tvar extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate);\n\t\t\tif(extra.filter && updateFilters)\n\t\t\t\tpasteFilter(view, extra, row, col, cutted, translate);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar item = grid.getItem(id);\n\t\tvar math = item[\"$\"+col];\n\t\tvar obj = { text:value, math:math, style:view.getStyle(id, col) };\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar filter = view.getCellFilter(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || filter || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = editor;\n\t\t\tif (filter) extra.filter = filter;\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\t\t\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","import {getType} from \"./types\";\n\nexport function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\tvar data = [];\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tgrid.eachRow(function(row){\n\t\tconst item = this.getItem(row);\n\t\tfor (var i=0; i<columns.length; i++){\n\t\t\tconst key = columns[i];\n\t\t\tlet value = item[key];\n\t\t\tconst css = item.$cellCss ? (item.$cellCss[key] || \"\") : \"\";\n\n\t\t\t//serialize instead of value if defined\n\t\t\tif (math && item[\"$\"+key])\n\t\t\t\tvalue = item[\"$\"+key];\n\n\t\t\t//put not empty values in serialization\n\t\t\tconst hasValue = value || value === 0;\n\t\t\tif (hasValue || css) {\n\t\t\t\tconst type = getType(view, row, key);\n\t\t\t\tdata.push([row*1, key*1, (hasValue ? value : \"\"), css, type]);\n\t\t\t}\n\t\t}\n\t}, true);\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n\n\tobj.data = data;\n}\n\nfunction _parse(view, obj){\n\tvar grid = view.$$(\"cells\");\n\n\tvar tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns) && (tconfig.frozenColumns+1) != grid.config.leftSplit)\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows) && tconfig.frozenRows != grid.config.topSplit)\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (var i = 0; i < obj.data.length; i++){\n\t\tvar [ row, column, value, , type ] = obj.data[i];\n\n\t\tif(typeof value == \"string\")\n\t\t\tvalue = value.replace(/^=link\\(/i, \"=HYPERLINK(\"); // LINK is deprecated\n\n\t\tvar item = grid.getItem(row);\n\t\titem[column] = value;\n\n\t\t//cell value can be updated via types module\n\t\tview.ignoreUndo(()=>{\n\t\t\tview.callEvent(\"onCellChange\", [row, column, value, type]);\n\t\t});\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, sel.start, sel.end, view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tconst inc = ids[0] > 1 ? 1 : -1;\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0] + inc}, {[type]: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split+1 >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split+1 >= start.row)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tview._hidden_cols_hash[i] = i;\n\n\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\tgrid.hideColumn(i);\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tlet s = start[name], e = s + inc;\n\t\tif(s > e) [s, e] = [e, s];\n\n\t\tfor(let i = s; i < e; i++){\n\t\t\tfor(let h = 0; h < data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0 ? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.getRow(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.sizes){\n\t\t\tfor (var i=0; i<data.sizes.length; i++){\n\t\t\t\tvar size = data.sizes[i];\n\t\t\t\tif (size[0]*1 !== 0){\n\t\t\t\t\tvar row = view.getRow(size[0]);\n\t\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t\t} else {\n\t\t\t\t\tvar col = view.getColumn(size[1]);\n\t\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.sizes.length)\n\t\t\t\tview.refresh(true);\n\t\t}\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar sizes = [];\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar columns = grid.getState().order;\n\t\tvar order = grid.data.order;\n\n\t\tvar defWidth = grid.config.columnWidth;\n\t\tvar defHeight = grid.config.rowHeight;\n\n\t\tfor (let i = 1; i < columns.length; i++){\n\t\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\t\tif (width && width != defWidth)\n\t\t\t\tsizes.push([0, i, width]);\n\t\t}\n\n\t\tfor (let i = 0; i < order.length; i++){\n\t\t\tvar height = grid.getItem(order[i]).$height;\n\t\t\tif (height && height != defHeight)\n\t\t\t\tsizes.push([order[i]*1, 0, height]);\n\t\t}\n\t\t\n\t\tdata.sizes = sizes;\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\tlet baseWidth = config.width;\n\n\t\t\t\tconst span = view._table.getSpan(row, col);\n\t\t\t\tif(span)\n\t\t\t\t\tbaseWidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\t\tif(view.getCellEditor(row, col) || view.getCellFilter(row, col))\n\t\t\t\t\tbaseWidth += 20;\n\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, baseWidth).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {updateMath} from \"../math/updater\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = parseFloat(a[key]) || -Infinity;\n\t\t\tlet d = parseFloat(b[key]) || -Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = (a[key] || \"\").toString().toLowerCase();\n\t\t\tlet d = (b[key] || \"\").toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir, type){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tlet key = view.getRow(range.start.row)[range.start.column];\n\t\ttype = type || (isNaN(parseFloat(key)) ? \"str\" : \"int\");\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst fullRow = view.getRow(row);\n\t\t\t\tlet value = fullRow[column];\n\t\t\t\tlet style = view.getStyle(row, column);\n\t\t\t\tlet math = fullRow[\"$\"+column];\n\t\t\t\tlet conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tmath: math,\n\t\t\t\t\trow: row,\n\t\t\t\t\tconditions: conditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\t\t\t\t\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst translate = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\trow: row - element.row,\n\t\t\t\t\t\tcolumn: 0\n\t\t\t\t\t};\n\t\t\t\t\tconst newMath = updateMath(element.math, translate);\n\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tlet table = view._table.$customPrint(options, true);\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\t\t\t\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\t\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\n\nexport function init(view){\n\tview.$exportView = function(options){\n\t\twebix.extend(options, { header: false, rawValues: true, spans: true, styles:true, math:true, xCorrection:1, ignore:{rowId:true}});\n\t\tif(options.export_mode ==\"excel\")\n\t\t\treturn _exportExcel(view, options);\n\t\telse\n\t\t\treturn view._table;\n\t};\n}\n\nfunction _exportExcel(view, options){\n\tif(options.sheets === true) \n\t\toptions.sheets  = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tconst sheet = options.sheets[i];\n\t\tconst id = sheet.id || sheet;\n\n\t\tview.showSheet(id);\n\t\toptions.xCorrection = view.$$(\"cells\").config.header ? 1 : 0;\n\n\t\tconst sheetOptions = sheet.options ? webix.extend(sheet.options, options) : webix.copy(options);\n\t\tif(!sheetOptions.name)\n\t\t\tsheetOptions.name = id;\n\n\t\tdata = data.concat(webix.toExcel(view._table, sheetOptions));\n\t\tdata[i].ranges = [];\n\n\t\tlet ranges = view.ranges.getRanges();\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\tdata[i].ranges.push({\n\t\t\t\tSheet:i,\n\t\t\t\tName:ranges[r].name,\n\t\t\t\tRef:sheetOptions.name+\"!\"+ranges[r].range.replace(/(\\w)/gi, function(match){ return \"$\"+match; })\n\t\t\t});\n\t\t}\n\t\tif(sheetOptions.styles)\n\t\t\tdata[i].styles = _getStyles(view, sheetOptions);\n\t}\n\tview.showSheet(active);\n\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(){\n\tlet d = defaultStyles;\n\treturn {\n\t\tfont:{\n\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t},\n\t\talignment:{\n\t\t\thorizontal:d[\"text-align\"],\n\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t}\n\t};\n}\n\nfunction _getStyles(view, options){\n\n\tview.compactStyles();\n\n\tlet result = [];\n\tlet cached = {};\n\tconst defaults = _getDefaults();\n\n\tif(options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.config.columns;\n\n\tlet rIndex = delta;\n\tgrid.eachRow((row) =>{\n\t\tfor (let cIndex = options.xCorrection; cIndex < columns.length; cIndex++){\n\t\t\tconst css = view.getStyle(row, columns[cIndex].id);\n\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\tresult[rIndex] = result[rIndex] || {};\n\n\t\t\tlet styles;\n\t\t\tif(css){\n\t\t\t\tif(cached[css.id])\n\t\t\t\t\tstyles = cached[css.id];\n\t\t\t\telse{\n\t\t\t\t\tstyles = _getCellStyle(css.text);\n\t\t\t\t\tfor(let name in defaults)\n\t\t\t\t\t\twebix.extend(styles[name], defaults[name]);\n\t\t\t\t\tcached[css.id] = styles;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tstyles = defaults;\n\n\t\t\tresult[rIndex][index] = webix.copy(styles);\n\t\t\tresult[rIndex][index].type = getType(view, row, columns[cIndex].id);\n\t\t}\n\t\trIndex++;\n\t});\n\n\tif(options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles){\n\tlet str = styles.split(\";\"), stl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":{\n\t\t\t\t\tlet fill = _safeColor(str[s]);\n\t\t\t\t\tif(fill && fill.toLowerCase() !==\"ffffff\")\n\t\t\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstl.alignment.horizontal = str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstl.font.italic = str[s] == \"italic\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstl.font.underline = str[s] == \"underline\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstl.font.bold = str[s] == \"bold\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstl.border.right = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstl.border.bottom = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstl.border.left = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstl.border.top = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn stl;\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"));\n}\n\n","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.right? (_safeColor(stl.border.right.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.bottom? (_safeColor(stl.border.bottom.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.left? (_safeColor(stl.border.left.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.top? (_safeColor(stl.border.top.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\nimport {adjustRow, adjustColumn} from \"../operations/column_operations\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++){\n\t\t\tif(size != \"auto\")\n\t\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t\t\telse\n\t\t\t\t(type == \"row\" ? adjustRow : adjustColumn)(i, view);\n\t\t}\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\t\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns)\n\t\tindex = grid.getColumnIndex(column*1+1);\n\tif (index<base) index = base;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = index > base ? column : 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows)\n\t\tindex = grid.getIndexById(row*1+1);\n\tif (index < 0) index = 0;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = index ? row : 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], num-span[1]+1);\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, num-span[0]+1, span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"../math/methods\";\nimport {image, chart} from \"../math/writer\";\nimport {getAccessor} from \"../math/sheet\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\treturn getAccessor(this, name);\n}\n\nexport function recalculate(){\n\tthis.callEvent(\"onMathRefresh\",[]);\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\nimport {clearFilters} from \"../operations/filter\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors){\n\t\tclearEditors(this, rangeStr);\n\t\tclearFilters(this, rangeStr);\n\t}\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tvar obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif (config && config.sheets)\n\t\treturn sheets.serialize(this, obj);\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column){\n\tvar item = this.getRow(row);\n\tvar value = item[\"$\"+column] || item[column];\n\t\n\tif (typeof value === \"undefined\") return \"\";\n\treturn value;\n}\nexport function setCellValue(row, column, value){\n\tif(this.getCellValue(row, column) !== value){\n\t\tvar item = this.getRow(row);\n\t\tvar old = item[\"$\"+column]||item[column];\n\n\t\t//onCellChange can change item (via types module)\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\t\titem[column] = value;\n\t\t\t\tdelete item[\"$\"+column];\n\n\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\t\tthis.saveCell(row, column);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","export function getRow(id){\n\treturn this._table.getItem(id);\n}\n\nexport function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\tline[column] = editor;\n\n\tif (editor && editor.editor){\n\t\tif (this.getCellFilter(row, column))\n\t\t\tthis.setCellFilter(row, column, null);\n\t\tthis._table.addCellCss(row,column, \"ss_editor\");\n\t} else {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_editor\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}","import * as flt from \"../operations/filter\";\n\nexport function setCellFilter(row, column, filter){\n\tconst line = this._table._ssFilters[row] = this._table._ssFilters[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\n\tif (filter && (webix.isArray(filter) || typeof filter == \"string\"))\n\t\tfilter = { options:filter };\n\tline[column] = filter;\n\n\tif (filter && typeof filter == \"object\"){\n\t\tif (this.getCellEditor(row, column))\n\t\t\tthis.setCellEditor(row, column, null);\n\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\t\tif (filter.value && flt.isValueActive(filter.value))\n\t\t\tthis._table.addCellCss(row,column, \"ss_filter_active\");\n\n\t\twebix.extend(filter, {row, column}, true);\n\t\tfilter.options = flt.calibrateRange(this, row, column, filter.options);\n\n\t\tif (!filter.handler && filter.value && filter.value.condition){\n\t\t\tconst mode = filter.mode || flt.getFilterMode(this, row, column);\n\t\t\tfilter.handler = flt.getFilterFunction(mode, filter.value);\n\t\t}\n\t} else {\n\t\tdelete this._table._ssFilters[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"filter\", { row, column, value, newValue:filter }]);\n}\n\nexport function getCellFilter(row, column){\n\tlet line = this._table._ssFilters[row] || {};\n\treturn line[column] || null;\n}\n\nexport function removeFilters(){\n\tconst filters = flt.getFilters(this._table);\n\n\tfor\t(let i=0; i<filters.length; i++){\n\t\tconst {row, column} = filters[i];\n\t\tthis.setCellFilter(row, column, null);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter((obj) => {\n\t\treturn this.isRowVisible(obj.id);\n\t});\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){\n\t\tconst filters = flt.getFilters(this._table);\n\n\t\t// hidden rows\n\t\tthis._table.data.filter((obj) => {\n\t\t\treturn this.isRowVisible(obj.id);\n\t\t});\n\n\t\tfor (let i=0; i<filters.length; i++){\n\t\t\tconst {row, column, handler} = filters[i];\n\n\t\t\tlet all = false;\n\t\t\tthis._table.data.filter(function(obj){\n\t\t\t\tif (all || obj.id*1 <= row*1) return true;\n\t\t\t\tif (!obj[column] && obj[column] !== \"\") return all = true;\n\t\t\t\treturn (typeof handler == \"function\") ? handler( String(obj[column]) ) : true;\n\t\t\t}, 1, true);\n\t\t}\n\t}, this);\n\n\tthis._table.callEvent(\"onAfterFilter\", []);\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"image\", submenu:[\n\t\t\t{ id: \"add-image-cell\"},\n\t\t\t{ id: \"add-image-top\"}\n\t\t]},\n\t\t{id: \"graph\", submenu:[\n\t\t\t{ id: \"add-sparkline\"},\n\t\t\t{ id: \"add-chart\"}\n\t\t]},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{ id: \"view\", submenu:[\n\t\t{id: \"columns\", submenu: [\n\t\t\t{id: \"insert-column\"},\n\t\t\t{id: \"delete-column\"},\n\t\t\t{id: \"show-column\"},\n\t\t\t{id: \"hide-column\"},\n\t\t\t{id: \"resize-column\"}\n\t\t]},\n\t\t{id: \"rows\", submenu: [\n\t\t\t{id: \"insert-row\"},\n\t\t\t{id: \"delete-row\"},\n\t\t\t{id: \"show-row\"},\n\t\t\t{id: \"hide-row\"},\n\t\t\t{id: \"resize-row\"}\n\t\t]},\n\t\t{ $template:\"Separator\" },\n\t\t{id: \"freeze-columns\"},\n\t\t{id: \"freeze-rows\"},\n\t\t{id: \"hide-gridlines\"},\n\t\t{id: \"hide-headers\"}\n\t]}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","function getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\nimport * as chart from \"./chart\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!obj.readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tclipboard : obj.clipboard,\n\t\t\tliveEditor: obj.liveEditor,\n\t\t\tclipboardDecimalDelimiter : obj.clipboardDecimalDelimiter\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\tif(obj.readonly)\n\t\t\trows.push(tbl.init(this, tblObj));\n\t\telse\n\t\t\trows.push({cols:[tbl.init(this, tblObj), chart.init(this)]});\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m16a from \"../math/math\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\nimport * as m30 from \"./views\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m3,m8,m17,m16a,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, flt, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["dayOfTheYear","date","start","Date","getFullYear","diff","getTimezoneOffset","Math","floor","getJsDateFromExcel","excelDate","round","getTime","getExcelDateFromJs","jsDate","toString","_to_number","v","isNaN","_combine","data","arr","i","length","concat","getJsDate","value","getExcelDate","webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","ui","richselect","defaults","width","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","rows","css","title","onChange","hide","getValue","$$","master","setValue","getList","getColorView","getSelectedId","getBody","getChildViews","getItemText","suggest","fitMaster","$ready","push","bind","getPopup","isArray","callEvent","join","height","palette","attachEvent","setMasterValue","colorboard","icon","borderless","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","datepicker","$prepareValue","copy","end","daterangepicker","buttons","close","getBodyConfig","content","elements","getFormElements","padding","skin","$active","layoutPadding","form","label","cancel","autowidth","click","getTopParentView","save","body_setter","_typeof","isUndefined","window","move","head","autofocus","IdSpace","headerRowHeight","datatable","a","setHTML","type","dataview","contextmenu","filter","item","editor","cursor","getInputNode","selectionStart","val","charAt","str1","substring","str2","search","toLowerCase","indexOf","node","tagName","_this","sizes","html","offset","textWidth","getTextSize","y","x","show","refresh","setValueHere","$enterKey","isVisible","group","set","method","uid","url","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","init","thread","events","handler","newName","params","_loading_data","getActiveSheet","clearTimeout","delay","decode","encode","alpha","prefixIndex","parseInt","str","adress","size","charCodeAt","col","substr","range","nind","sheet","parts","split","ranges","getCode","d1","d2","notAlphaNum","escapeSheet","test","toRange","x2","y2","rangeObj","row","column","eachRange","callback","rangeTest","isRange","changeRange","inc","updated","r1","c1","r2","c2","toolbarSizes","paddingY","sectorPadding","sectorMargin","defaultStyles","sizeEl","style_names","_style_map","left","center","right","top","middle","bottom","wrap","border_checks","cell","area","mode","_style_handlers","getSelectArea","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","removeStyle","getStyle","styles","getRow","$cellCss","styleid","addStyle","props","origin","_styleFromText","key","_styleToText","cache","_addStyle","_parse","styleObj","update_style_data","nstyle","$cellFormat","format","setStyle","_setStyle","setRangeStyle","baseWidth","innerHTML","_table","appendChild","max","offsetWidth","offsetHeight","removeChild","old","oldFormat","formatChanged","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatsCount","formatSources","formatCache","formatHelpers","setDefaultFormats","formatsLocale","price","getFormat","extra","priceFormat","values","extend","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","format2code","dateFormat","string","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","createFormatName","addFormat","nev","removeFormat","splitFormat","conditional","delimiters","errorMessage","code","separated","separateFmt","genCode","condition","fmt","Function","check","line","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","multiply","lastDateType","betweenPlaceholders","placeholder","datePart","excelDateToWebix","undefined","map","decimal","getParts","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","Object","keys","sort","b","timeOrder","typesOrder","order","types","j","changeAreaDecimals","cells","getCells","r","c","getItem","firstValue","firstStyle","rules","isNumber","changeCellDecimals","isCustom","updateDecimals","parsed","decimals","placeholders","Array","slice","withoutText","withoutPlaceholders","hasOwnProperty","formValues","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","index","Infinity","k","checkFormat","checkTime","quot","getFormatName","isDateInvalid","getDateEditFormat","formatName","locale","isTime","dateToStr","load","defaultFormats","isChar","char","getWord","formula","passive","quotes","operand","isPosition","position","word","sum","flags","chars","errorCode","e","namedRangeCode","deps","sheetInd","rangeCode","t","crosssheet","lines","ph","escaped","next","pushLine","getPopupConfig","onItemClick","button","suggestData","highlight","_highlightedCells","_update_range","_last_value_set","showActiveSheet","updateCellValue","moveSelection","preventEvent","eventRemove","keydownEv","event","_this2","endEdit","escapeText","escape","changeCellCss","_ranges","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","_activeMath","activeSheet","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","activeCell","define","showSheet","_this3","remove","which","keyCode","dir","getItemNode","newv","getCellValue","setCellValue","$handleSelection","$setValueHere","setSelectionRange","expectRange","trim","expectOperator","setRange","pos","len","lastPos","prepareArea","first","second","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","$allowsClear","blockEvent","unblockEvent","arrow","elementsConfig","labelWidth","_initOnChange","$eventSource","_getCheckboxes","count","$all","_count","base","forEach","labelRight","active","baseHeight","inputHeight","checkboxes","output","scrollview","queryView","onSelectChange","focus","resize","toFront","minWidth","minHeight","escHide","autofit","setAttribute","UIManager","addHotKey","_removeView","getMenu","_clickEv","_menu","destructor","move_setter","DragControl","addDrag","$dragPos","$dragCreate","object","trg","target","getAttribute","elOffset","elPos","pOffset","parentNode","state","getScrollState","toNode","$dragDestroy","submenu","readonly","onMenuItemClick","_menuActions","onBeforeShow","_toggleExcel","dots","toPDF","display","toPNG","header","pull","showItem","hideItem","layoutMargin","multi","getSectionConfig","onAfterScroll","addSection","trashIcon","dataPadding","oldVal","hidden","markersVisible","onClick","removeView","childs","getLayout","lastIndex","layoutId","addView","setValues","setSubValue","sub","hideMarkers","marker","child","getValues","editors","excel_date","createPopup","icons","timepicker","_last_input_target","onEnter","render","showPopup","input","updateCalendar","calendar","afterRender","ss_richselect","exists","popupInit","$value","actions","span","isMerged","c0","getSpan","splitCell","confirm","then","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","toggleButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","align","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","currency","example","number","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","barStyles","getBarStyles","dropdowns","getCellStyles","cellStyle","property","splice","action","updateValue","element","toolbar","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","source","viewId","innerId","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","columnWidth","getColumnConfig","eachRow","getCellEditor","getCellFilter","setColumnWidth","adjustRow","eachColumn","getSpanNode","setRowHeight","highlightColRow","sr","er","sc","ec","removeCellCss","addCellCss","getHeaderNode","removeCss","addCss","dragStartColumn","dragEndColumn","grid","showCommentHandler","comments","_activeComment","editStatus","locate","visible","commentsView","get","viewonly","contains","math","editMath","highlightHeaders","ids","cop","st","ed","ev","getEditor","isCellLocked","finalStep","resizeColumn","cind","dx","posRelative","columnId","selectColumnHandler","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","getFocus","need_focus","setFocus","setDefaultCss","$name","spans","leftSplit","areaselect","minColumnWidth","editable","editaction","minRowHeight","navigation","clipboard","clipboardDecimalDelimiter","templateCopy","cell_template","valueOnly","invalidDate","helper","newValue","clearAll","columnCount","rowCount","el","nms","refreshColumns","parse","env","isMac","sel","$anyKey","edit","del","styleHotKey","ctrlU","ctrlP","attr","elementOn","SUM","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","product","SUMPRODUCT","sets","sp","s","SUMSQ","sq","pow","VARP","avg","STDEVP","sqrt","POWER","num","n","p","QUOTIENT","div","d","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","digits","parseFloat","toFixed","ROUNDDOWN","ROUNDUP","ceil","TRUNC","EVEN","ODD","CONCATENATE","LEFT","MID","RIGHT","LOWER","UPPER","toUpperCase","PROPER","temp","idx","TRIM","LEN","DATE","year","month","day","TIME","hour","minute","DAY","getDate","MONTH","getMonth","YEAR","NOW","DATEDIF","unit","startDateDays","months","IMAGE","SPARKLINE","color1","color2","negativeColor","Sparklines","getTemplate","HYPERLINK","IF","neg","methods","dateToExcel","getFormatType","formatType","getType","$cellType","setType","_setType","isFormula","parseDate","mathFormat","getMathFormat","blockLevel","level","part","expectType","getExpectType","parser","strToDate","parseDateTime","ignoreUndo","updateCell","cellEditor","setFormat","timeFormat","setCellEditor","checkType","strings","other","methodsName","updateEditor","fillEditor","startEdit","clear","disableEditor","disabled","disable","enable","en","pasteRange","updateRange","isEnabled","clearEditor","isActiveCell","find","func","findIndex","getDimension","spanEndRow","spanEndCol","actionMap","_activeSheet","add","prepare","selectSheet","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","tabWidth","context","dataOrder","_sheets","rename","defaultBottom","editValue","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","disableItem","enableItem","batch","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","tabs","getActive","_resetTable","Dialog","$dialog","$hide","$show","unescape","DialogBox","box","preview","parseImage","server","images","image","showPreview","upload","startLoad","endLoad","onSaveClick","okClick","onCancelClick","fillUrl","addImage","file","reader","FileReader","onload","getFormView","readAsDataURL","response","imageURL","viewid","open","views","update","actives","passives","core","struct","pair","pairsheet","rawword","triggers","_build_function","error_function","clearMathCache","activeOnly","updateMath","stack","isRowFix","isColumnFix","checkRange","cut","isRow","updateSheetNames","oldName","thisSheet","multiSheet","getAccessor","_mathSheetCache","helpers","passiveAccessor","page","formulas","_mathSheetHelpers","_mathSheetCore","getRangeCode","getCell","execute","getName","getRange","activeAccessor","SheetAccessor","getRangeValue","getRangeCols","rangeToData","rind","sheetName","getRangeRows","rangeOptions","unique","empty","String","objA","objB","sorters","sorting","as","int","unshift","nullFilter","$empty","Ranges","_master","accessor","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","getTypes","typesChangeHandler","dialog","sparkConfig","addSparkline","alert","rangeValues","clearValidation","getSelectedRange","getRanges","toSheetRange","validate","updateItem","theform","removeRange","editRange","correct","gravity","saveClick","autoheight","lockCss","lockCell","_mapCellsCalls","_locks","cm","lock","updatePosition","locked","addSpan","extraCss","getExtraCss","setSpanValue","isEmpty","removeSpan","lx","ly","rx","ry","cx","cy","setSpanCss","borderChecks","adjustSpan","checkSpan","selection","isFirstCell","oldValue","pasteSpan","cutted","translate","mapCells","rid","cid","isUndo","undoSpan","checkSpanBorders","_ssFilters","markBarFilter","getFilters","filters","clearFilters","refilter","filterSpreadSheet","calibrateRange","getFilterRange","isValueActive","includes","isFilterExists","getFilterMode","pasteFilter","setCellFilter","getSingleOption","conditions","getConditions","getFilterFunction","opt","isDate","lastIndexOf","on_click","ssheet_filter_sign","on_dblclick","toggleFilters","removeFilters","isFilter","$mode","$filter","syncScroll","_getTargetNode","getFilter","flt","importData","relative","field","inputs","applyFilter","setCellStyle","isHidden","nodeOffset","tableOffset","getElementsByClassName","ydiff","xdiff","scrollSize","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","fullDateFormat","longDateFormat","getFormats","updateForm","paddingX","closeWin","isText","forms","_normalizeValue","value2","collection","_formatValue","editFormat","_safeInt","_getCondition","activeValue","_setCondition","_clean","onFocus","current_view","_this4","onBlur","clearRow","getRows","getConditionStyle","conditionStyle","_this5","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","onViewResize","animate","showInput","addComment","comment","showTemplate","changeTextarea","getHead","$height","rowHeight","getOption","optionHeight","bases","imt","imc","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","_trackAll","_pull","track","_types","_trackOne","conf","_fromRange","_showAll","win","_correctPos","_showOne","_getWidth","$width","_getHeight","each","_isRange","switchDirection","dataSeries","subdata","_isPie","legend","fromData","shift","names","_getNames","legendRange","_getParts","_getSeries","vals","xAxis","activeVals","series","activeVal","_getColor","colors","dataRange","subRange","_normalizeConfig","valign","scale","querySelector","register","container","_commands","getConfig","inner","renderConfig","_processTables","query","tables","dt","_reset","_undoUI","_updateData","one","viewIds","_genChartConfig","htmlFilter","scaleColor","legendConfig","_pieConfig","pieInnerText","borderColor","lineColor","yAxis","lineShape","circle","chartEditor","handlePieLegend","getLeftColumn","getTopRow","setSilentValue","updateLegendRange","updateXaxisRange","xAxisRange","leftColumn","topRow","exist","updateAlign","updateValign","updateType","getTabbar","switchRowsCols","stacked","hideField","hideBatch","hideOption","showOption","updateSeries","pie","inValues","expand","closeEditor","outValues","activeSkin","barHeight","complexData","addRichselect","getLegendAlign","getLegendValign","process","newData","oldData","getUpdateValues","_addColumn","add_column_count","_delColumn","del_column_count","deleted","_addRow","add_row_count","_delRow","del_row_count","loadChangedData","fixSelectArea","calculate","get_core","_execute","error","isFinite","rs","vs","m","backtrak","skip_math","solvedMath","solvedCounter","applyMath","tkey","check_trigger","srow","scolumn","recalckAll","getState","recalckCell","remove_triggers","trs","back","adds","bcell","add_triggers","blist","add_backtrack","holders","setPlaceholder","psh","param","option","addEmptyCollection","_empty","rowId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","handlers","type_action","_undoCondition","_setCssFormat","cssFormat","_ssEditors","clearEditors","pasteDropdown","dropdown","styledata","clipdata","updateFilters","ignore","$popup","tblEditors","isEditor","_clipboardToTable","cdata","fromSheet","ctrlKey","metaKey","_get_sel_style","mapSelection","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","record","_add_row_col","maxRow","maxCol","row_ind","col_ind","subtrans","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","topSplit","hasValue","_undoValue","_hidden_cols_hash","_hidden_rows_hash","isColumnVisible","setState","indexes","getIds","_showRow","_showColumn","_hideRow","_hideColumn","isRowVisible","showColumn","unselect","hideColumn","_updatePosition","h","hrows","hcols","_adjustRowHeight","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","o","bs","blockStart","blockEnd","res","removeSelectArea","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","fullRow","newMath","gridlines","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getStyles","cached","_getDefaults","font","sz","alignment","horizontal","wrapText","docHeader","_getDocStyle","delta","rIndex","cIndex","_getCellStyle","stl","border","rgb","fill","fgColor","italic","underline","bold","$exportView","rawValues","export_mode","_exportExcel","dataOnly","sheetOptions","Sheet","Name","Ref","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","_getTypes","safe","_parseExcel","driver","full","_parseCsv","getRecords","clearRange","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changeSpan","getColumnIndex","getIndexById","hideRow","chart","getSheetData","recalculate","registerMathMethod","addMethod","sid","spn","prop","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","cb","tbl","ok","resetUndo","groupUndo","changeDecimals","defaultMenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","material","subbar","tblObj","attachTo","lists","submenuConfig","sizeToContent","getMenuItem","contextMenu","dialogs","viewBases","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m8","m17","m16a","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","$onLoad","excel","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":";;;;;;;;uJAAO,SAASA,EAAaC,OACtBC,EAAQ,IAAIC,KAAKF,EAAKG,cAAe,EAAG,GACxCC,EAAQJ,EAAOC,EAAmE,IAAxDA,EAAMI,oBAAsBL,EAAKK,qBAA4B,WACtFC,KAAKC,MAAMH,SAGZ,SAASI,EAAmBC,OAC5BT,EAAO,IAAIE,KAAKI,KAAKI,MAA4B,OAArBD,EAAY,OAAiB,aACxD,IAAIP,KAAKF,EAAKW,UAAuC,IAA3BX,EAAKK,qBAGhC,SAASO,EAAmBC,UACX,OAAUA,EAAOF,UAA0C,IAA7BE,EAAOR,4BACtCS,WAGhB,SAASC,EAAWC,YACvBA,GAAW,IAANA,IACPA,GAAM,EACFC,MAAMD,MAAWA,EAKhB,SAASE,EAASC,WACpBC,EAAM,GACDC,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAChCD,EAAMA,EAAIG,OAAOJ,EAAKE,WAEhBD,EC3BR,SAASI,EAAUC,UACbA,GAAmB,IAAVA,GAAkBA,aAAiBvB,MAAUe,MAAMQ,KAChEA,EAAQjB,EAAmBiB,IAErBA,EAGR,SAASC,EAAaD,UACjBA,GAASA,aAAiBvB,OAC7BuB,EAAQb,EAAmBa,IAErBA,6hECZRE,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,gCACG,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,+BACT,gCACQ,+BACG,iCACF,kCACE,kBAEf,sBACM,4BACD,qBACC,mBAEH,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,+BACA,gCACA,WAEZ,oBAEU;qBACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH,yBACQ,8BACD,wBAEP,wBACO,0BACJ,0BAEA,gBACF,+BAEc,gFACA,8EACH,6EACN,gCAEP,sBACM,sCACG,iCACH,4BACC,yBACC,6BACH,uBACD,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,oBAEP,gBAEF,eACC,uBACM,6BAEH,qBACE,sBACD,4BAEE,wBACA,wBACA,uBAED,6BACI,iCACA,gCACE,0BAEP,oBACA,mBACD,oBACE,oBACF,oBACE,uBACC,4BACI,2BAEN,qBACC,4BACM,kCACA,mCACA,iCACF,6CACA,2CACE,6BAEL,4BACI,2CACA,iDACE,oCACA,4BACD,4BACC,8BACC,+BACA,oCACH,4BACG,+BACA,sBAET,uBACG,wBACF,6BACO,mBACV,wBACE,uBACG,6BAEE,mCACF,uBACH,uBAEG,iCACO,kCACE,mCACD,gCACF,yBAEL,oCACF,0BAEM,iBAEtBC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,2BACK,6BACD,qCACF,oCACC,yCACE,sCACN,8CACE,qCACF,wBACA,yBACJ;WACG,eACL,cACG,gBACD,oBACI,wBACI,sBACF,WAEhBC,MAAM,gBACW,8BACA,oBACR,aACD,kBACM,2BACG,mCACA,wBACP,sBACK,yBACN,YACA,YACA,eACG,0BACM,gCACA,8BACF,4BACA,8BACE,qBACT,oBACM,0BACA,wBACF,sBACA,wBACE,oBACJ,8BACY,2BACb,sBACK,uBACA,qCACc,+CACH,yCACR,uBACL,YACH,yBACQ,8BACD,wBACP,wBACO,0BACJ,uBACJ,kBACI,uBACC,oBACL,kBACI,0BACC,mBACL,wBACU,wCACH,wCACG,qCACF,oCACC,uCACD,2BACH,yBACJ,sBACK,WAEfC,MAAM,cACQ,uBACE,oBAEhBC,WAAW,MACH,SAERC,QAAQ,YACO,wBACA,6BACI,8BACA,uCACD,8BACJ,aChTfR,MAAMS,QAAQ,CACbC,KAAM,eACNC,SAAS,aACTC,MAAO,SAASC,GACfA,EAAOC,QAAW,CACjBC,KAAK,cACLC,KAAK,CACJD,KAAM,eACNE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"}